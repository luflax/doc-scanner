{"version":3,"file":"enhance-BvHcUBvg.js","sources":["../../src/components/enhance/FilterCarousel.tsx","../../src/components/enhance/AdjustmentSliders.tsx","../../src/components/enhance/EnhanceView.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport type { FilterPreset } from '@/types';\nimport { FILTER_PRESET_INFO } from '@/constants/filters';\n\ninterface FilterCarouselProps {\n  selectedFilter: FilterPreset;\n  onSelect: (filter: FilterPreset) => void;\n  disabled?: boolean;\n}\n\nexport const FilterCarousel: React.FC<FilterCarouselProps> = ({\n  selectedFilter,\n  onSelect,\n  disabled = false,\n}) => {\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const selectedButtonRef = useRef<HTMLButtonElement>(null);\n\n  // Scroll to selected filter on mount and when selection changes\n  useEffect(() => {\n    if (selectedButtonRef.current && scrollContainerRef.current) {\n      selectedButtonRef.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'nearest',\n        inline: 'center',\n      });\n    }\n  }, [selectedFilter]);\n\n  return (\n    <div className=\"w-full bg-white border-b border-gray-200\">\n      <div\n        ref={scrollContainerRef}\n        className=\"flex gap-2 px-4 py-3 overflow-x-auto scrollbar-hide\"\n        style={{\n          scrollSnapType: 'x mandatory',\n          WebkitOverflowScrolling: 'touch',\n        }}\n      >\n        {FILTER_PRESET_INFO.map((filter) => {\n          const isSelected = filter.id === selectedFilter;\n\n          return (\n            <button\n              key={filter.id}\n              ref={isSelected ? selectedButtonRef : null}\n              onClick={() => !disabled && onSelect(filter.id)}\n              disabled={disabled}\n              className={`\n                flex-shrink-0 flex flex-col items-center justify-center\n                min-w-[80px] px-3 py-2 rounded-lg\n                transition-all duration-200\n                ${\n                  isSelected\n                    ? 'bg-blue-500 text-white shadow-md scale-105'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }\n                ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n                scroll-snap-align-center\n              `}\n              style={{ scrollSnapAlign: 'center' }}\n            >\n              <span className=\"text-2xl mb-1\">{filter.icon}</span>\n              <span className=\"text-xs font-medium text-center leading-tight\">\n                {filter.name}\n              </span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport type { EnhancementOptions } from '@/types';\n\ninterface AdjustmentSlidersProps {\n  options: EnhancementOptions;\n  onChange: (options: EnhancementOptions) => void;\n  disabled?: boolean;\n}\n\ninterface SliderProps {\n  label: string;\n  value: number;\n  min: number;\n  max: number;\n  step: number;\n  onChange: (value: number) => void;\n  disabled?: boolean;\n  unit?: string;\n}\n\nconst Slider: React.FC<SliderProps> = ({\n  label,\n  value,\n  min,\n  max,\n  step,\n  onChange,\n  disabled = false,\n  unit = '',\n}) => {\n  const percentage = ((value - min) / (max - min)) * 100;\n\n  return (\n    <div className=\"mb-4\">\n      <div className=\"flex justify-between items-center mb-2\">\n        <label className=\"text-sm font-medium text-gray-700\">{label}</label>\n        <span className=\"text-sm text-gray-500\">\n          {value.toFixed(step < 1 ? 1 : 0)}\n          {unit}\n        </span>\n      </div>\n      <div className=\"relative\">\n        <input\n          type=\"range\"\n          min={min}\n          max={max}\n          step={step}\n          value={value}\n          onChange={(e) => onChange(parseFloat(e.target.value))}\n          disabled={disabled}\n          className={`\n            w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\n            ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n          `}\n          style={{\n            background: `linear-gradient(to right, #3b82f6 0%, #3b82f6 ${percentage}%, #e5e7eb ${percentage}%, #e5e7eb 100%)`,\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport const AdjustmentSliders: React.FC<AdjustmentSlidersProps> = ({\n  options,\n  onChange,\n  disabled = false,\n}) => {\n  const handleChange = (key: keyof EnhancementOptions, value: number) => {\n    onChange({\n      ...options,\n      [key]: value,\n    });\n  };\n\n  return (\n    <div className=\"bg-white p-4 rounded-lg\">\n      <h3 className=\"text-sm font-semibold text-gray-800 mb-4\">Manual Adjustments</h3>\n\n      <Slider\n        label=\"Brightness\"\n        value={options.brightness}\n        min={-100}\n        max={100}\n        step={1}\n        onChange={(v) => handleChange('brightness', v)}\n        disabled={disabled}\n      />\n\n      <Slider\n        label=\"Contrast\"\n        value={options.contrast}\n        min={-100}\n        max={100}\n        step={1}\n        onChange={(v) => handleChange('contrast', v)}\n        disabled={disabled}\n      />\n\n      <Slider\n        label=\"Saturation\"\n        value={options.saturation}\n        min={-100}\n        max={100}\n        step={1}\n        onChange={(v) => handleChange('saturation', v)}\n        disabled={disabled}\n      />\n\n      <Slider\n        label=\"Gamma\"\n        value={options.gamma}\n        min={0.1}\n        max={3.0}\n        step={0.1}\n        onChange={(v) => handleChange('gamma', v)}\n        disabled={disabled}\n      />\n\n      {/* Reset button */}\n      <button\n        onClick={() =>\n          onChange({\n            brightness: 0,\n            contrast: 0,\n            saturation: 0,\n            sharpness: 0,\n            gamma: 1.0,\n            shadows: 0,\n            highlights: 0,\n            temperature: 0,\n          })\n        }\n        disabled={disabled}\n        className=\"w-full mt-2 px-4 py-2 text-sm text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n      >\n        Reset Adjustments\n      </button>\n    </div>\n  );\n};\n","import React, { useRef, useEffect, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport { useStore } from '@/store';\nimport { Button } from '@/components/common/Button';\nimport { Spinner } from '@/components/common/Spinner';\nimport { FilterCarousel } from './FilterCarousel';\nimport { AdjustmentSliders } from './AdjustmentSliders';\nimport { imageEnhancementService } from '@/services/ImageEnhancementService';\nimport { getStorageService } from '@/services/StorageService';\nimport type { FilterPreset, EnhancementOptions, Document, DocumentPage } from '@/types';\nimport { DEFAULT_ENHANCEMENT_OPTIONS } from '@/constants/filters';\n\nexport const EnhanceView: React.FC = () => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [currentImageData, setCurrentImageData] = useState<ImageData | null>(null);\n  const [showAdjustments, setShowAdjustments] = useState(false);\n\n  const {\n    currentImage,\n    processedImage,\n    adjustedCorners,\n    selectedFilter,\n    enhancementOptions,\n    setCurrentView,\n    setSelectedFilter,\n    setEnhancementOptions,\n    addDocument,\n    resetScanSession,\n    addToast,\n  } = useStore((state) => ({\n    currentImage: state.scanSession.currentImage,\n    processedImage: state.scanSession.processedImage,\n    adjustedCorners: state.scanSession.adjustedCorners,\n    selectedFilter: state.scanSession.selectedFilter,\n    enhancementOptions: state.scanSession.enhancementOptions,\n    setCurrentView: state.setCurrentView,\n    setSelectedFilter: state.setSelectedFilter,\n    setEnhancementOptions: state.setEnhancementOptions,\n    addDocument: state.addDocument,\n    resetScanSession: state.resetScanSession,\n    addToast: state.addToast,\n  }));\n\n  // Initialize with processed image\n  useEffect(() => {\n    if (processedImage && !currentImageData) {\n      setCurrentImageData(processedImage);\n      drawImageToCanvas(processedImage);\n    }\n  }, [processedImage]);\n\n  // Apply filter when selection changes\n  useEffect(() => {\n    if (processedImage) {\n      applyFilter(selectedFilter);\n    }\n  }, [selectedFilter]);\n\n  // Apply manual adjustments\n  useEffect(() => {\n    if (currentImageData && hasManualAdjustments(enhancementOptions)) {\n      applyManualAdjustments();\n    }\n  }, [enhancementOptions]);\n\n  const drawImageToCanvas = (imageData: ImageData) => {\n    if (!canvasRef.current) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    canvas.width = imageData.width;\n    canvas.height = imageData.height;\n    ctx.putImageData(imageData, 0, 0);\n  };\n\n  const applyFilter = async (filter: FilterPreset) => {\n    if (!processedImage) return;\n\n    setIsProcessing(true);\n    try {\n      const result = await imageEnhancementService.applyFilter(processedImage, filter);\n\n      if (result) {\n        setCurrentImageData(result);\n        drawImageToCanvas(result);\n\n        // Reset manual adjustments when changing filter\n        setEnhancementOptions(DEFAULT_ENHANCEMENT_OPTIONS);\n      } else {\n        addToast({\n          type: 'error',\n          message: 'Failed to apply filter',\n        });\n      }\n    } catch (error) {\n      console.error('Filter application failed:', error);\n      addToast({\n        type: 'error',\n        message: 'Filter application failed',\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const applyManualAdjustments = async () => {\n    if (!currentImageData) return;\n\n    setIsProcessing(true);\n    try {\n      // Get the base filtered image (reapply current filter to processed image)\n      let baseImage = processedImage;\n      if (selectedFilter !== 'original') {\n        baseImage = await imageEnhancementService.applyFilter(processedImage!, selectedFilter);\n      }\n\n      if (!baseImage) {\n        throw new Error('Failed to get base image');\n      }\n\n      // Apply manual adjustments on top of filtered image\n      const result = await imageEnhancementService.enhance(baseImage, enhancementOptions);\n\n      if (result) {\n        setCurrentImageData(result);\n        drawImageToCanvas(result);\n      } else {\n        addToast({\n          type: 'error',\n          message: 'Failed to apply adjustments',\n        });\n      }\n    } catch (error) {\n      console.error('Manual adjustment failed:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const hasManualAdjustments = (options: EnhancementOptions): boolean => {\n    return (\n      options.brightness !== 0 ||\n      options.contrast !== 0 ||\n      options.saturation !== 0 ||\n      options.gamma !== 1.0\n    );\n  };\n\n  const handleFilterSelect = (filter: FilterPreset) => {\n    setSelectedFilter(filter);\n  };\n\n  const handleAdjustmentChange = (options: EnhancementOptions) => {\n    setEnhancementOptions(options);\n  };\n\n  const handleSave = async () => {\n    if (!currentImageData || !currentImage) {\n      addToast({\n        type: 'error',\n        message: 'No image to save',\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n    try {\n      // Convert ImageData to Blob for storage\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      if (!ctx) throw new Error('Failed to get canvas context');\n\n      canvas.width = currentImageData.width;\n      canvas.height = currentImageData.height;\n      ctx.putImageData(currentImageData, 0, 0);\n\n      const processedBlob = await new Promise<Blob>((resolve, reject) => {\n        canvas.toBlob((blob) => {\n          if (blob) resolve(blob);\n          else reject(new Error('Failed to convert canvas to blob'));\n        }, 'image/png');\n      });\n\n      // Convert original ImageData to Blob\n      const originalCanvas = document.createElement('canvas');\n      const originalCtx = originalCanvas.getContext('2d');\n      if (!originalCtx) throw new Error('Failed to get canvas context');\n\n      originalCanvas.width = currentImage.width;\n      originalCanvas.height = currentImage.height;\n      originalCtx.putImageData(currentImage, 0, 0);\n\n      const originalBlob = await new Promise<Blob>((resolve, reject) => {\n        originalCanvas.toBlob((blob) => {\n          if (blob) resolve(blob);\n          else reject(new Error('Failed to convert canvas to blob'));\n        }, 'image/png');\n      });\n\n      // Create thumbnail (smaller version for grid view)\n      const thumbnailCanvas = document.createElement('canvas');\n      const thumbnailCtx = thumbnailCanvas.getContext('2d');\n      if (!thumbnailCtx) throw new Error('Failed to get canvas context');\n\n      const maxThumbSize = 300;\n      const scale = Math.min(\n        maxThumbSize / currentImageData.width,\n        maxThumbSize / currentImageData.height\n      );\n\n      thumbnailCanvas.width = currentImageData.width * scale;\n      thumbnailCanvas.height = currentImageData.height * scale;\n      thumbnailCtx.drawImage(canvas, 0, 0, thumbnailCanvas.width, thumbnailCanvas.height);\n\n      const thumbnailBlob = await new Promise<Blob>((resolve, reject) => {\n        thumbnailCanvas.toBlob((blob) => {\n          if (blob) resolve(blob);\n          else reject(new Error('Failed to convert canvas to blob'));\n        }, 'image/jpeg', 0.8);\n      });\n\n      // Create document page\n      const page: DocumentPage = {\n        id: uuidv4(),\n        pageNumber: 1,\n        originalImage: originalBlob,\n        processedImage: processedBlob,\n        thumbnailImage: thumbnailBlob,\n        corners: adjustedCorners || [],\n        enhancementSettings: enhancementOptions,\n        filterApplied: selectedFilter,\n        dimensions: {\n          width: currentImageData.width,\n          height: currentImageData.height,\n        },\n      };\n\n      // Create document\n      const now = new Date();\n      const documentName = `Document ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;\n      const newDocument: Document = {\n        id: uuidv4(),\n        name: documentName,\n        createdAt: now,\n        updatedAt: now,\n        pages: [page],\n        tags: [],\n        metadata: {\n          totalPages: 1,\n          hasOCR: false,\n          fileSize: processedBlob.size,\n          source: 'camera',\n        },\n      };\n\n      // Save to storage\n      const storageService = await getStorageService();\n      await storageService.createDocument(newDocument);\n\n      // Update store\n      addDocument(newDocument);\n\n      // Reset scan session\n      resetScanSession();\n\n      addToast({\n        type: 'success',\n        message: 'Document saved successfully',\n      });\n\n      // Navigate to documents view\n      setCurrentView('documents');\n    } catch (error) {\n      console.error('Failed to save document:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to save document',\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  if (!processedImage) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-gray-50 p-6\">\n        <p className=\"text-gray-600\">No image to enhance</p>\n        <Button onClick={() => setCurrentView('camera')} className=\"mt-4\">\n          Back to Camera\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full bg-gray-900\">\n      {/* Canvas container */}\n      <div className=\"flex-1 overflow-hidden flex items-center justify-center p-4 relative\">\n        <canvas\n          ref={canvasRef}\n          className=\"max-w-full max-h-full object-contain shadow-2xl\"\n        />\n\n        {/* Processing overlay */}\n        {isProcessing && (\n          <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\n            <div className=\"bg-white rounded-lg p-4 flex items-center gap-3\">\n              <Spinner size=\"sm\" />\n              <span className=\"text-sm text-gray-700\">Processing...</span>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Filter carousel */}\n      <FilterCarousel\n        selectedFilter={selectedFilter}\n        onSelect={handleFilterSelect}\n        disabled={isProcessing}\n      />\n\n      {/* Adjustment controls toggle */}\n      <div className=\"bg-white border-t border-gray-200 px-4 py-2\">\n        <button\n          onClick={() => setShowAdjustments(!showAdjustments)}\n          className=\"w-full flex items-center justify-between text-sm font-medium text-gray-700 hover:text-gray-900\"\n        >\n          <span>Manual Adjustments</span>\n          <span className=\"text-lg\">{showAdjustments ? '▼' : '▶'}</span>\n        </button>\n      </div>\n\n      {/* Adjustment sliders */}\n      {showAdjustments && (\n        <div className=\"bg-gray-50 border-t border-gray-200 max-h-80 overflow-y-auto\">\n          <AdjustmentSliders\n            options={enhancementOptions}\n            onChange={handleAdjustmentChange}\n            disabled={isProcessing}\n          />\n        </div>\n      )}\n\n      {/* Action buttons */}\n      <div className=\"p-4 bg-white border-t border-gray-200\">\n        <div className=\"flex gap-3\">\n          <Button\n            onClick={() => setCurrentView('crop')}\n            variant=\"secondary\"\n            fullWidth\n            disabled={isProcessing}\n          >\n            Back\n          </Button>\n          <Button\n            onClick={handleSave}\n            variant=\"primary\"\n            fullWidth\n            disabled={isProcessing}\n          >\n            Save Document\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["FilterCarousel","selectedFilter","onSelect","disabled","scrollContainerRef","useRef","selectedButtonRef","useEffect","current","scrollIntoView","behavior","block","inline","jsx","className","children","ref","style","scrollSnapType","WebkitOverflowScrolling","FILTER_PRESET_INFO","map","filter","isSelected","id","jsxs","onClick","scrollSnapAlign","icon","name","Slider","label","value","min","max","step","onChange","unit","percentage","toFixed","type","e","parseFloat","target","background","AdjustmentSliders","options","handleChange","key","brightness","v","contrast","saturation","gamma","sharpness","shadows","highlights","temperature","EnhanceView","canvasRef","isProcessing","setIsProcessing","useState","currentImageData","setCurrentImageData","showAdjustments","setShowAdjustments","currentImage","processedImage","adjustedCorners","enhancementOptions","setCurrentView","setSelectedFilter","setEnhancementOptions","addDocument","resetScanSession","addToast","useStore","state","scanSession","drawImageToCanvas","applyFilter","hasManualAdjustments","applyManualAdjustments","imageData","canvas","ctx","getContext","width","height","putImageData","async","result","imageEnhancementService","DEFAULT_ENHANCEMENT_OPTIONS","message","error","baseImage","Error","enhance","Spinner","size","Button","variant","fullWidth","document","createElement","processedBlob","Promise","resolve","reject","toBlob","blob","originalCanvas","originalCtx","originalBlob","thumbnailCanvas","thumbnailCtx","maxThumbSize","scale","Math","drawImage","thumbnailBlob","page","uuidv4","pageNumber","originalImage","thumbnailImage","corners","enhancementSettings","filterApplied","dimensions","now","Date","documentName","toLocaleDateString","toLocaleTimeString","newDocument","createdAt","updatedAt","pages","tags","metadata","totalPages","hasOCR","fileSize","source","storageService","getStorageService","createDocument"],"mappings":"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"}