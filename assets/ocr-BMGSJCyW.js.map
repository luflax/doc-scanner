{"version":3,"file":"ocr-BMGSJCyW.js","sources":["../../src/components/ocr/OCRView.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useStore } from '@/store';\nimport { getOCRService } from '@/services/OCRService';\nimport { getStorageService } from '@/services/StorageService';\nimport { Button } from '@/components/common/Button';\nimport { IconButton } from '@/components/common/IconButton';\nimport { Spinner } from '@/components/common/Spinner';\nimport type { OCRProgress } from '@/types';\n\nconst AVAILABLE_LANGUAGES = [\n  { code: 'eng', name: 'English', tier: 1 },\n  { code: 'spa', name: 'Spanish', tier: 1 },\n  { code: 'fra', name: 'French', tier: 1 },\n  { code: 'deu', name: 'German', tier: 1 },\n  { code: 'ita', name: 'Italian', tier: 1 },\n  { code: 'por', name: 'Portuguese', tier: 1 },\n  { code: 'rus', name: 'Russian', tier: 1 },\n  { code: 'jpn', name: 'Japanese', tier: 1 },\n  { code: 'chi_sim', name: 'Chinese Simplified', tier: 1 },\n  { code: 'kor', name: 'Korean', tier: 1 },\n] as const;\n\nexport const OCRView: React.FC = () => {\n  const {\n    currentDocument,\n    processedImage,\n    isProcessing,\n    progress,\n    result,\n    selectedLanguages,\n    isInitialized,\n    setOCRInitialized,\n    setOCRProcessing,\n    setOCRProgress,\n    setOCRResult,\n    setSelectedLanguages,\n    setCurrentDocument,\n    setDocuments,\n    setCurrentView,\n    addToast,\n  } = useStore((state) => ({\n    currentDocument: state.documents.currentDocument,\n    processedImage: state.scanSession.processedImage,\n    isProcessing: state.ocr.isProcessing,\n    progress: state.ocr.progress,\n    result: state.ocr.result,\n    selectedLanguages: state.ocr.selectedLanguages,\n    isInitialized: state.ocr.isInitialized,\n    setOCRInitialized: state.setOCRInitialized,\n    setOCRProcessing: state.setOCRProcessing,\n    setOCRProgress: state.setOCRProgress,\n    setOCRResult: state.setOCRResult,\n    setSelectedLanguages: state.setSelectedLanguages,\n    setCurrentDocument: state.setCurrentDocument,\n    setDocuments: state.setDocuments,\n    setCurrentView: state.setCurrentView,\n    addToast: state.addToast,\n  }));\n\n  const [editedText, setEditedText] = useState('');\n  const [showLanguageSelector, setShowLanguageSelector] = useState(false);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const ocrService = getOCRService();\n\n  // Initialize OCR service\n  useEffect(() => {\n    const initOCR = async () => {\n      if (!isInitialized) {\n        try {\n          setOCRProcessing(true);\n          await ocrService.initialize(selectedLanguages, (progress: OCRProgress) => {\n            setOCRProgress(progress.progress * 100);\n          });\n          setOCRInitialized(true);\n          setOCRProcessing(false);\n          setOCRProgress(0);\n        } catch (error) {\n          console.error('Failed to initialize OCR:', error);\n          addToast({\n            type: 'error',\n            message: 'Failed to initialize OCR service',\n          });\n          setOCRProcessing(false);\n        }\n      }\n    };\n\n    initOCR();\n  }, []);\n\n  // Load document's processed image if viewing from documents\n  useEffect(() => {\n    const loadDocumentImage = async () => {\n      if (currentDocument && currentDocument.pages.length > 0 && !processedImage) {\n        try {\n          const firstPage = currentDocument.pages[0];\n          const img = new Image();\n          img.onload = () => {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            if (ctx) {\n              canvas.width = img.width;\n              canvas.height = img.height;\n              ctx.drawImage(img, 0, 0);\n              const imageData = ctx.getImageData(0, 0, img.width, img.height);\n\n              // Draw to display canvas\n              if (canvasRef.current) {\n                const displayCtx = canvasRef.current.getContext('2d');\n                if (displayCtx) {\n                  canvasRef.current.width = imageData.width;\n                  canvasRef.current.height = imageData.height;\n                  displayCtx.putImageData(imageData, 0, 0);\n                }\n              }\n            }\n          };\n          img.src = URL.createObjectURL(firstPage.processedImage);\n\n          // Load existing OCR result if available\n          if (firstPage.ocrResult) {\n            setOCRResult(firstPage.ocrResult);\n          }\n        } catch (error) {\n          console.error('Failed to load document image:', error);\n        }\n      }\n    };\n\n    loadDocumentImage();\n  }, [currentDocument]);\n\n  // Draw processed image on canvas\n  useEffect(() => {\n    if (processedImage && canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      if (ctx) {\n        canvas.width = processedImage.width;\n        canvas.height = processedImage.height;\n        ctx.putImageData(processedImage, 0, 0);\n      }\n    }\n  }, [processedImage]);\n\n  // Update edited text when result changes\n  useEffect(() => {\n    if (result) {\n      setEditedText(result.text);\n    }\n  }, [result]);\n\n  const handleStartOCR = async () => {\n    // Use document's image or session's processed image\n    const imageToProcess = processedImage || (currentDocument && canvasRef.current\n      ? canvasRef.current.getContext('2d')?.getImageData(\n          0, 0, canvasRef.current.width, canvasRef.current.height\n        )\n      : null);\n\n    if (!imageToProcess) {\n      addToast({\n        type: 'error',\n        message: 'No image to process',\n      });\n      return;\n    }\n\n    try {\n      setOCRProcessing(true);\n      setOCRProgress(0);\n\n      const result = await ocrService.recognize(\n        imageToProcess,\n        {\n          pageSegMode: 3, // AUTO\n          preserveInterwordSpaces: true,\n        }\n      );\n\n      setOCRProgress(100);\n\n      setOCRResult(result);\n      setOCRProcessing(false);\n      setOCRProgress(0);\n\n      // Auto-save if document exists\n      if (currentDocument) {\n        await handleSaveOCR(result);\n      }\n\n      addToast({\n        type: 'success',\n        message: `Text extracted with ${result.confidence.toFixed(1)}% confidence`,\n      });\n    } catch (error) {\n      console.error('OCR failed:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to extract text from image',\n      });\n      setOCRProcessing(false);\n      setOCRProgress(0);\n    }\n  };\n\n  const handleSaveOCR = async (ocrResult?: typeof result) => {\n    if (!currentDocument) {\n      addToast({\n        type: 'warning',\n        message: 'No document to save OCR results to',\n      });\n      return;\n    }\n\n    const resultToSave = ocrResult || result;\n    if (!resultToSave) {\n      addToast({\n        type: 'error',\n        message: 'No OCR results to save',\n      });\n      return;\n    }\n\n    try {\n      // Update the document's first page with OCR results\n      const updatedDocument = {\n        ...currentDocument,\n        pages: currentDocument.pages.map((page, index) =>\n          index === 0 ? { ...page, ocrResult: resultToSave } : page\n        ),\n        metadata: {\n          ...currentDocument.metadata,\n          hasOCR: true,\n        },\n        updatedAt: new Date(),\n      };\n\n      // Save to storage\n      const storageService = await getStorageService();\n      await storageService.updateDocument(updatedDocument);\n\n      // Update store\n      setCurrentDocument(updatedDocument);\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      addToast({\n        type: 'success',\n        message: 'OCR results saved to document',\n      });\n    } catch (error) {\n      console.error('Failed to save OCR results:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to save OCR results',\n      });\n    }\n  };\n\n  const handleLanguageToggle = (langCode: string) => {\n    const newLanguages = selectedLanguages.includes(langCode)\n      ? selectedLanguages.filter((l) => l !== langCode)\n      : [...selectedLanguages, langCode];\n\n    if (newLanguages.length === 0) {\n      addToast({\n        type: 'warning',\n        message: 'At least one language must be selected',\n      });\n      return;\n    }\n\n    setSelectedLanguages(newLanguages);\n    setOCRInitialized(false); // Force re-initialization with new languages\n  };\n\n  const handleCopyText = () => {\n    if (editedText) {\n      navigator.clipboard.writeText(editedText);\n      addToast({\n        type: 'success',\n        message: 'Text copied to clipboard',\n      });\n    }\n  };\n\n  const handleShareText = async () => {\n    if (!editedText) return;\n\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          text: editedText,\n          title: 'Extracted Text',\n        });\n      } catch (error) {\n        // User cancelled share\n      }\n    } else {\n      handleCopyText();\n    }\n  };\n\n  if (!processedImage) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-gray-50 p-6\">\n        <div className=\"text-6xl mb-4\">üìÑ</div>\n        <h2 className=\"text-xl font-semibold mb-2\">No Image to Process</h2>\n        <p className=\"text-sm text-gray-600 mb-6 text-center max-w-md\">\n          Capture and enhance a document first before extracting text.\n        </p>\n        <Button onClick={() => setCurrentView('camera')} variant=\"primary\" size=\"lg\">\n          Go to Camera\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full bg-white\">\n      {/* Image Preview */}\n      <div className=\"flex-shrink-0 bg-gray-900 relative overflow-hidden\" style={{ height: '30%' }}>\n        <canvas\n          ref={canvasRef}\n          className=\"absolute inset-0 w-full h-full object-contain\"\n        />\n      </div>\n\n      {/* Controls */}\n      <div className=\"flex-shrink-0 bg-white border-b border-gray-200 p-3\">\n        <div className=\"flex items-center justify-between gap-2\">\n          <div className=\"flex items-center gap-2\">\n            <Button\n              onClick={handleStartOCR}\n              disabled={isProcessing || !isInitialized}\n              variant=\"primary\"\n              size=\"md\"\n            >\n              {isProcessing ? 'Processing...' : result ? 'Re-scan Text' : 'Extract Text'}\n            </Button>\n            <button\n              onClick={() => setShowLanguageSelector(!showLanguageSelector)}\n              className=\"px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n              disabled={isProcessing}\n            >\n              {selectedLanguages.length === 1\n                ? AVAILABLE_LANGUAGES.find((l) => l.code === selectedLanguages[0])?.name\n                : `${selectedLanguages.length} languages`}\n            </button>\n          </div>\n\n          {result && (\n            <div className=\"flex items-center gap-2\">\n              <IconButton\n                icon=\"üìã\"\n                onClick={handleCopyText}\n                title=\"Copy text\"\n                size=\"md\"\n              />\n              <IconButton\n                icon=\"üì§\"\n                onClick={handleShareText}\n                title=\"Share text\"\n                size=\"md\"\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Progress Bar */}\n        {isProcessing && (\n          <div className=\"mt-3\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <span className=\"text-xs text-gray-600\">\n                {progress < 100 ? 'Initializing...' : 'Recognizing text...'}\n              </span>\n              <span className=\"text-xs text-gray-600\">{Math.round(progress)}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div\n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                style={{ width: `${progress}%` }}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* Language Selector */}\n        {showLanguageSelector && (\n          <div className=\"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200\">\n            <h3 className=\"text-sm font-medium mb-2\">Select Languages</h3>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {AVAILABLE_LANGUAGES.map((lang) => (\n                <label\n                  key={lang.code}\n                  className=\"flex items-center gap-2 p-2 rounded hover:bg-gray-100 cursor-pointer\"\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedLanguages.includes(lang.code)}\n                    onChange={() => handleLanguageToggle(lang.code)}\n                    className=\"rounded border-gray-300\"\n                    disabled={isProcessing}\n                  />\n                  <span className=\"text-sm\">{lang.name}</span>\n                </label>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Confidence Score */}\n        {result && !isProcessing && (\n          <div className=\"mt-2 text-xs text-gray-600\">\n            Confidence: {result.confidence.toFixed(1)}% ‚Ä¢ {result.words.length} words detected\n          </div>\n        )}\n      </div>\n\n      {/* Text Output */}\n      <div className=\"flex-1 overflow-hidden flex flex-col p-4 bg-gray-50\">\n        {!result && !isProcessing && (\n          <div className=\"flex-1 flex items-center justify-center text-center\">\n            <div>\n              <div className=\"text-4xl mb-2\">üîç</div>\n              <p className=\"text-gray-600 text-sm\">\n                Click \"Extract Text\" to start OCR\n              </p>\n            </div>\n          </div>\n        )}\n\n        {isProcessing && (\n          <div className=\"flex-1 flex items-center justify-center\">\n            <div className=\"text-center\">\n              <Spinner size=\"lg\" />\n              <p className=\"text-sm text-gray-600 mt-4\">\n                Extracting text from document...\n              </p>\n            </div>\n          </div>\n        )}\n\n        {result && !isProcessing && (\n          <div className=\"flex-1 flex flex-col overflow-hidden\">\n            <label className=\"text-sm font-medium text-gray-700 mb-2\">\n              Extracted Text (editable)\n            </label>\n            <textarea\n              value={editedText}\n              onChange={(e) => setEditedText(e.target.value)}\n              className=\"flex-1 w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Extracted text will appear here...\"\n            />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"],"names":["AVAILABLE_LANGUAGES","code","name","tier","OCRView","currentDocument","processedImage","isProcessing","progress","result","selectedLanguages","isInitialized","setOCRInitialized","setOCRProcessing","setOCRProgress","setOCRResult","setSelectedLanguages","setCurrentDocument","setDocuments","setCurrentView","addToast","useStore","state","documents","scanSession","ocr","editedText","setEditedText","useState","showLanguageSelector","setShowLanguageSelector","canvasRef","useRef","ocrService","getOCRService","useEffect","async","initialize","error","type","message","initOCR","pages","length","firstPage","img","Image","onload","canvas","document","createElement","ctx","getContext","width","height","drawImage","imageData","getImageData","current","displayCtx","putImageData","src","URL","createObjectURL","ocrResult","loadDocumentImage","text","handleSaveOCR","resultToSave","updatedDocument","map","page","index","metadata","hasOCR","updatedAt","Date","storageService","getStorageService","updateDocument","docs","listDocuments","sortBy","sortOrder","handleCopyText","navigator","clipboard","writeText","jsxs","className","children","jsx","style","ref","Button","onClick","imageToProcess","recognize","pageSegMode","preserveInterwordSpaces","confidence","toFixed","disabled","variant","size","find","l","IconButton","icon","title","share","Math","round","lang","checked","includes","onChange","langCode","newLanguages","filter","handleLanguageToggle","words","Spinner","value","e","target","placeholder"],"mappings":"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"}