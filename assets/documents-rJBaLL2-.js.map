{"version":3,"file":"documents-rJBaLL2-.js","sources":["../../src/components/common/StorageInfo.tsx","../../src/components/documents/DocumentsView.tsx","../../src/components/documents/DocumentDetailView.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getStorageService } from '@/services/StorageService';\nimport type { StorageUsage } from '@/types';\n\ninterface StorageInfoProps {\n  compact?: boolean;\n}\n\nexport const StorageInfo: React.FC<StorageInfoProps> = ({ compact = false }) => {\n  const [usage, setUsage] = useState<StorageUsage | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    loadStorageUsage();\n  }, []);\n\n  const loadStorageUsage = async () => {\n    try {\n      const storageService = await getStorageService();\n      const storageUsage = await storageService.getStorageUsage();\n      setUsage(storageUsage);\n    } catch (error) {\n      console.error('Failed to load storage usage:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formatBytes = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n  };\n\n  if (isLoading) {\n    return compact ? (\n      <span className=\"text-xs text-gray-500\">Loading...</span>\n    ) : (\n      <div className=\"text-sm text-gray-600\">Loading storage info...</div>\n    );\n  }\n\n  if (!usage || usage.quota === 0) {\n    return compact ? (\n      <span className=\"text-xs text-gray-500\">Storage: N/A</span>\n    ) : (\n      <div className=\"text-sm text-gray-600\">Storage information not available</div>\n    );\n  }\n\n  const getUsageColor = (percentage: number): string => {\n    if (percentage < 50) return 'bg-green-500';\n    if (percentage < 80) return 'bg-yellow-500';\n    return 'bg-red-500';\n  };\n\n  if (compact) {\n    return (\n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-xs text-gray-600\">\n          {formatBytes(usage.used)} / {formatBytes(usage.quota)}\n        </span>\n        <div className=\"w-16 h-2 bg-gray-200 rounded-full overflow-hidden\">\n          <div\n            className={`h-full ${getUsageColor(usage.percentage)} transition-all duration-300`}\n            style={{ width: `${Math.min(usage.percentage, 100)}%` }}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n      <h3 className=\"text-sm font-medium text-gray-900 mb-2\">Storage Usage</h3>\n\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-600\">Used</span>\n          <span className=\"font-medium\">{formatBytes(usage.used)}</span>\n        </div>\n\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-600\">Total</span>\n          <span className=\"font-medium\">{formatBytes(usage.quota)}</span>\n        </div>\n\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-600\">Used</span>\n          <span className=\"font-medium\">{usage.percentage.toFixed(1)}%</span>\n        </div>\n\n        <div className=\"w-full h-3 bg-gray-200 rounded-full overflow-hidden mt-2\">\n          <div\n            className={`h-full ${getUsageColor(usage.percentage)} transition-all duration-300`}\n            style={{ width: `${Math.min(usage.percentage, 100)}%` }}\n          />\n        </div>\n\n        {usage.percentage > 80 && (\n          <div className=\"mt-2 text-xs text-orange-600 bg-orange-50 p-2 rounded\">\n            ‚ö†Ô∏è Storage is running low. Consider deleting old documents.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React, { useEffect, useState } from 'react';\nimport { useStore } from '@/store';\nimport { getStorageService } from '@/services/StorageService';\nimport { getBulkExportService } from '@/services/BulkExportService';\nimport { Button } from '@/components/common/Button';\nimport { Spinner } from '@/components/common/Spinner';\nimport { StorageInfo } from '@/components/common/StorageInfo';\nimport type { Document, PDFExportOptions, ImageExportOptions } from '@/types';\nimport type { BulkExportFormat } from '@/services/BulkExportService';\n\nexport const DocumentsView: React.FC = () => {\n  const {\n    documents,\n    selectedDocumentIds,\n    setDocuments,\n    setCurrentDocument,\n    removeDocument,\n    toggleDocumentSelection,\n    clearDocumentSelection,\n    selectAllDocuments,\n    setCurrentView,\n    addToast,\n  } = useStore((state) => ({\n    documents: state.documents.list,\n    selectedDocumentIds: state.documents.selectedDocumentIds,\n    setDocuments: state.setDocuments,\n    setCurrentDocument: state.setCurrentDocument,\n    removeDocument: state.removeDocument,\n    toggleDocumentSelection: state.toggleDocumentSelection,\n    clearDocumentSelection: state.clearDocumentSelection,\n    selectAllDocuments: state.selectAllDocuments,\n    setCurrentView: state.setCurrentView,\n    addToast: state.addToast,\n  }));\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [thumbnails, setThumbnails] = useState<Map<string, string>>(new Map());\n  const [isSelectionMode, setIsSelectionMode] = useState(false);\n  const [isExporting, setIsExporting] = useState(false);\n  const [exportProgress, setExportProgress] = useState({ current: 0, total: 0 });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filteredDocuments, setFilteredDocuments] = useState<Document[]>([]);\n\n  // Load documents from storage on mount\n  useEffect(() => {\n    loadDocuments();\n  }, []);\n\n  // Load thumbnails for documents\n  useEffect(() => {\n    if (documents.length > 0) {\n      loadThumbnails();\n    }\n  }, [documents]);\n\n  // Filter documents based on search query\n  useEffect(() => {\n    if (!searchQuery.trim()) {\n      setFilteredDocuments(documents);\n    } else {\n      const query = searchQuery.toLowerCase();\n      const filtered = documents.filter((doc) => {\n        // Search in document name\n        if (doc.name.toLowerCase().includes(query)) {\n          return true;\n        }\n        // Search in tags\n        if (doc.tags.some((tag) => tag.toLowerCase().includes(query))) {\n          return true;\n        }\n        // Search in OCR text\n        if (doc.metadata.hasOCR) {\n          for (const page of doc.pages) {\n            if (page.ocrResult && page.ocrResult.text.toLowerCase().includes(query)) {\n              return true;\n            }\n          }\n        }\n        return false;\n      });\n      setFilteredDocuments(filtered);\n    }\n  }, [documents, searchQuery]);\n\n  const loadDocuments = async () => {\n    try {\n      const storageService = await getStorageService();\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n    } catch (error) {\n      console.error('Failed to load documents:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to load documents',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadThumbnails = async () => {\n    const newThumbnails = new Map<string, string>();\n\n    for (const doc of documents) {\n      if (doc.pages.length > 0) {\n        const firstPage = doc.pages[0];\n        const url = URL.createObjectURL(firstPage.thumbnailImage);\n        newThumbnails.set(doc.id, url);\n      }\n    }\n\n    setThumbnails(newThumbnails);\n\n    // Cleanup old URLs\n    return () => {\n      thumbnails.forEach((url) => URL.revokeObjectURL(url));\n    };\n  };\n\n  const handleDocumentClick = (document: Document) => {\n    if (isSelectionMode) {\n      toggleDocumentSelection(document.id);\n    } else {\n      setCurrentDocument(document);\n      setCurrentView('detail'); // Go to detail view\n    }\n  };\n\n  const handleToggleSelectionMode = () => {\n    if (isSelectionMode) {\n      clearDocumentSelection();\n    }\n    setIsSelectionMode(!isSelectionMode);\n  };\n\n  const handleSelectAll = () => {\n    if (selectedDocumentIds.length === documents.length) {\n      clearDocumentSelection();\n    } else {\n      selectAllDocuments();\n    }\n  };\n\n  const handleBulkExport = async (format: BulkExportFormat) => {\n    if (selectedDocumentIds.length === 0) {\n      addToast({\n        type: 'error',\n        message: 'No documents selected',\n      });\n      return;\n    }\n\n    try {\n      setIsExporting(true);\n      setExportProgress({ current: 0, total: selectedDocumentIds.length });\n\n      const bulkExportService = getBulkExportService();\n      const selectedDocs = documents.filter((doc) =>\n        selectedDocumentIds.includes(doc.id)\n      );\n\n      const pdfOptions: PDFExportOptions = {\n        pageSize: 'a4',\n        orientation: 'auto',\n        quality: 'high',\n        includeOCR: false,\n        compression: true,\n      };\n\n      const imageOptions: ImageExportOptions = {\n        format: 'png',\n        quality: 90,\n      };\n\n      const zipBlob = await bulkExportService.exportDocumentsAsZip(\n        selectedDocs,\n        {\n          format,\n          pdfOptions,\n          imageOptions,\n        },\n        (progress) => {\n          setExportProgress({ current: progress.current, total: progress.total });\n        }\n      );\n\n      // Download the zip file\n      const filename = bulkExportService.generateZipFilename(\n        selectedDocumentIds.length,\n        format\n      );\n      const url = URL.createObjectURL(zipBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = filename;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      addToast({\n        type: 'success',\n        message: `Successfully exported ${selectedDocumentIds.length} document${selectedDocumentIds.length !== 1 ? 's' : ''}`,\n      });\n\n      // Exit selection mode after export\n      setIsSelectionMode(false);\n      clearDocumentSelection();\n    } catch (error) {\n      console.error('Bulk export failed:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to export documents',\n      });\n    } finally {\n      setIsExporting(false);\n      setExportProgress({ current: 0, total: 0 });\n    }\n  };\n\n  const handleDeleteDocument = async (e: React.MouseEvent, docId: string) => {\n    e.stopPropagation();\n\n    if (!confirm('Are you sure you want to delete this document?')) {\n      return;\n    }\n\n    try {\n      const storageService = await getStorageService();\n      await storageService.deleteDocument(docId);\n      removeDocument(docId);\n\n      addToast({\n        type: 'success',\n        message: 'Document deleted',\n      });\n    } catch (error) {\n      console.error('Failed to delete document:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to delete document',\n      });\n    }\n  };\n\n  const handleOCRDocument = async (e: React.MouseEvent, document: Document) => {\n    e.stopPropagation();\n    setCurrentDocument(document);\n    setCurrentView('ocr');\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-full bg-gray-50\">\n        <div className=\"text-center\">\n          <Spinner size=\"lg\" />\n          <p className=\"text-sm text-gray-600 mt-4\">Loading documents...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (documents.length === 0) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-gray-50 p-6\">\n        <div className=\"text-6xl mb-4\">üìÅ</div>\n        <h2 className=\"text-xl font-semibold mb-2\">No Documents Yet</h2>\n        <p className=\"text-sm text-gray-600 mb-6 text-center max-w-md\">\n          Start by scanning your first document using the camera.\n        </p>\n        <Button onClick={() => setCurrentView('camera')} variant=\"primary\" size=\"lg\">\n          Scan Document\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full bg-gray-50 flex flex-col\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 p-4\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-lg font-semibold\">My Documents</h2>\n          <div className=\"flex gap-2\">\n            <Button\n              onClick={handleToggleSelectionMode}\n              variant={isSelectionMode ? 'secondary' : 'outline'}\n              size=\"sm\"\n            >\n              {isSelectionMode ? 'Cancel' : 'Select'}\n            </Button>\n            {!isSelectionMode && (\n              <Button\n                onClick={() => setCurrentView('camera')}\n                variant=\"primary\"\n                size=\"sm\"\n              >\n                + New Scan\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Search Bar */}\n        {!isSelectionMode && documents.length > 0 && (\n          <div className=\"mt-3\">\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder=\"Search documents, tags, or text...\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\n            />\n          </div>\n        )}\n\n        <div className=\"flex items-center justify-between mt-2\">\n          <p className=\"text-sm text-gray-600\">\n            {isSelectionMode && selectedDocumentIds.length > 0\n              ? `${selectedDocumentIds.length} selected`\n              : searchQuery\n              ? `${filteredDocuments.length} of ${documents.length} document${documents.length !== 1 ? 's' : ''}`\n              : `${documents.length} document${documents.length !== 1 ? 's' : ''}`}\n          </p>\n          {isSelectionMode && (\n            <button\n              onClick={handleSelectAll}\n              className=\"text-sm text-blue-600 hover:text-blue-700\"\n            >\n              {selectedDocumentIds.length === documents.length ? 'Deselect All' : 'Select All'}\n            </button>\n          )}\n        </div>\n\n        {/* Storage Info */}\n        {!isSelectionMode && (\n          <div className=\"mt-3\">\n            <StorageInfo compact />\n          </div>\n        )}\n      </div>\n\n      {/* Documents Grid */}\n      <div className=\"flex-1 overflow-y-auto p-4\">\n        <div className=\"grid grid-cols-2 gap-4\">\n          {filteredDocuments.map((doc) => {\n            const isSelected = selectedDocumentIds.includes(doc.id);\n            return (\n              <div\n                key={doc.id}\n                onClick={() => handleDocumentClick(doc)}\n                className={`bg-white rounded-lg shadow hover:shadow-lg transition-all cursor-pointer overflow-hidden ${\n                  isSelected ? 'ring-2 ring-blue-500' : ''\n                }`}\n              >\n                {/* Thumbnail */}\n                <div className=\"aspect-[3/4] bg-gray-200 relative overflow-hidden\">\n                  {thumbnails.has(doc.id) ? (\n                    <img\n                      src={thumbnails.get(doc.id)}\n                      alt={doc.name}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\n                      <span className=\"text-4xl\">üìÑ</span>\n                    </div>\n                  )}\n\n                  {/* Selection checkbox */}\n                  {isSelectionMode && (\n                    <div className=\"absolute top-2 left-2\">\n                      <input\n                        type=\"checkbox\"\n                        checked={isSelected}\n                        onChange={() => toggleDocumentSelection(doc.id)}\n                        onClick={(e) => e.stopPropagation()}\n                        className=\"w-6 h-6 cursor-pointer\"\n                      />\n                    </div>\n                  )}\n\n                  {/* Delete button overlay */}\n                  {!isSelectionMode && (\n                    <button\n                      onClick={(e) => handleDeleteDocument(e, doc.id)}\n                      className=\"absolute top-2 right-2 w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg transition-colors\"\n                      title=\"Delete document\"\n                    >\n                      √ó\n                    </button>\n                  )}\n                </div>\n\n              {/* Document Info */}\n              <div className=\"p-3\">\n                <h3 className=\"text-sm font-medium truncate mb-1\">{doc.name}</h3>\n                <div className=\"flex items-center justify-between text-xs text-gray-500\">\n                  <span>{doc.pages.length} page{doc.pages.length !== 1 ? 's' : ''}</span>\n                  <span>{doc.metadata.hasOCR ? '‚úì OCR' : ''}</span>\n                </div>\n                <div className=\"text-xs text-gray-400 mt-1\">\n                  {new Date(doc.updatedAt).toLocaleDateString()}\n                </div>\n\n                {/* Quick Actions */}\n                {!isSelectionMode && (\n                  <div className=\"flex gap-2 mt-2\">\n                    {!doc.metadata.hasOCR && (\n                      <button\n                        onClick={(e) => handleOCRDocument(e, doc)}\n                        className=\"flex-1 px-2 py-1 text-xs bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition-colors\"\n                      >\n                        Extract Text\n                      </button>\n                    )}\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setCurrentDocument(doc);\n                        setCurrentView('export');\n                      }}\n                      className=\"flex-1 px-2 py-1 text-xs bg-green-50 text-green-600 rounded hover:bg-green-100 transition-colors\"\n                    >\n                      Export\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Bulk Export Action Bar */}\n      {isSelectionMode && selectedDocumentIds.length > 0 && (\n        <div className=\"bg-white border-t border-gray-200 p-4 shadow-lg\">\n          {isExporting ? (\n            <div className=\"text-center\">\n              <Spinner size=\"sm\" />\n              <p className=\"text-sm text-gray-600 mt-2\">\n                Exporting {exportProgress.current} of {exportProgress.total}...\n              </p>\n            </div>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={() => handleBulkExport('pdf')}\n                variant=\"primary\"\n                size=\"md\"\n                className=\"flex-1\"\n              >\n                üìÑ Export as PDFs\n              </Button>\n              <Button\n                onClick={() => handleBulkExport('images')}\n                variant=\"secondary\"\n                size=\"md\"\n                className=\"flex-1\"\n              >\n                üñºÔ∏è Export as Images\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useStore } from '@/store';\nimport { getStorageService } from '@/services/StorageService';\nimport { Button } from '@/components/common/Button';\nimport { IconButton } from '@/components/common/IconButton';\nimport { Spinner } from '@/components/common/Spinner';\nimport type { Document, DocumentPage } from '@/types';\n\nexport const DocumentDetailView: React.FC = () => {\n  const {\n    currentDocument,\n    setCurrentDocument,\n    setDocuments,\n    setCurrentView,\n    addToast,\n  } = useStore((state) => ({\n    currentDocument: state.documents.currentDocument,\n    setCurrentDocument: state.setCurrentDocument,\n    setDocuments: state.setDocuments,\n    setCurrentView: state.setCurrentView,\n    addToast: state.addToast,\n  }));\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [documentName, setDocumentName] = useState('');\n  const [thumbnails, setThumbnails] = useState<Map<string, string>>(new Map());\n  const [newTag, setNewTag] = useState('');\n  const [draggedPageIndex, setDraggedPageIndex] = useState<number | null>(null);\n  const [dragOverPageIndex, setDragOverPageIndex] = useState<number | null>(null);\n\n  useEffect(() => {\n    if (currentDocument) {\n      setDocumentName(currentDocument.name);\n      loadThumbnails();\n    }\n  }, [currentDocument]);\n\n  const loadThumbnails = async () => {\n    if (!currentDocument) return;\n\n    const newThumbnails = new Map<string, string>();\n    for (const page of currentDocument.pages) {\n      const url = URL.createObjectURL(page.thumbnailImage);\n      newThumbnails.set(page.id, url);\n    }\n    setThumbnails(newThumbnails);\n\n    return () => {\n      thumbnails.forEach((url) => URL.revokeObjectURL(url));\n    };\n  };\n\n  const handleSaveName = async () => {\n    if (!currentDocument || !documentName.trim()) {\n      addToast({\n        type: 'error',\n        message: 'Document name cannot be empty',\n      });\n      return;\n    }\n\n    try {\n      const updatedDocument = {\n        ...currentDocument,\n        name: documentName.trim(),\n        updatedAt: new Date(),\n      };\n\n      const storageService = await getStorageService();\n      await storageService.updateDocument(updatedDocument);\n\n      setCurrentDocument(updatedDocument);\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      setIsEditing(false);\n      addToast({\n        type: 'success',\n        message: 'Document name updated',\n      });\n    } catch (error) {\n      console.error('Failed to update document name:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to update document name',\n      });\n    }\n  };\n\n  const handleAddTag = async () => {\n    if (!currentDocument || !newTag.trim()) return;\n\n    const tag = newTag.trim();\n    if (currentDocument.tags.includes(tag)) {\n      addToast({\n        type: 'warning',\n        message: 'Tag already exists',\n      });\n      return;\n    }\n\n    try {\n      const updatedDocument = {\n        ...currentDocument,\n        tags: [...currentDocument.tags, tag],\n        updatedAt: new Date(),\n      };\n\n      const storageService = await getStorageService();\n      await storageService.updateDocument(updatedDocument);\n\n      setCurrentDocument(updatedDocument);\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      setNewTag('');\n      addToast({\n        type: 'success',\n        message: 'Tag added',\n      });\n    } catch (error) {\n      console.error('Failed to add tag:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to add tag',\n      });\n    }\n  };\n\n  const handleRemoveTag = async (tag: string) => {\n    if (!currentDocument) return;\n\n    try {\n      const updatedDocument = {\n        ...currentDocument,\n        tags: currentDocument.tags.filter((t) => t !== tag),\n        updatedAt: new Date(),\n      };\n\n      const storageService = await getStorageService();\n      await storageService.updateDocument(updatedDocument);\n\n      setCurrentDocument(updatedDocument);\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      addToast({\n        type: 'success',\n        message: 'Tag removed',\n      });\n    } catch (error) {\n      console.error('Failed to remove tag:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to remove tag',\n      });\n    }\n  };\n\n  const handleDeletePage = async (pageId: string) => {\n    if (!currentDocument) return;\n\n    if (currentDocument.pages.length === 1) {\n      addToast({\n        type: 'error',\n        message: 'Cannot delete the last page. Delete the document instead.',\n      });\n      return;\n    }\n\n    if (!confirm('Are you sure you want to delete this page?')) {\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const storageService = await getStorageService();\n      await storageService.removePage(currentDocument.id, pageId);\n\n      // Reload document\n      const updatedDocument = await storageService.getDocument(currentDocument.id);\n      if (updatedDocument) {\n        setCurrentDocument(updatedDocument);\n      }\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      addToast({\n        type: 'success',\n        message: 'Page deleted',\n      });\n    } catch (error) {\n      console.error('Failed to delete page:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to delete page',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleDragStart = (index: number) => {\n    setDraggedPageIndex(index);\n  };\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault();\n    setDragOverPageIndex(index);\n  };\n\n  const handleDrop = async (e: React.DragEvent, dropIndex: number) => {\n    e.preventDefault();\n    if (!currentDocument || draggedPageIndex === null || draggedPageIndex === dropIndex) {\n      setDraggedPageIndex(null);\n      setDragOverPageIndex(null);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n\n      // Reorder pages array\n      const pages = [...currentDocument.pages];\n      const [draggedPage] = pages.splice(draggedPageIndex, 1);\n      pages.splice(dropIndex, 0, draggedPage);\n\n      // Get page IDs in new order\n      const pageIds = pages.map((p) => p.id);\n\n      const storageService = await getStorageService();\n      await storageService.reorderPages(currentDocument.id, pageIds);\n\n      // Reload document\n      const updatedDocument = await storageService.getDocument(currentDocument.id);\n      if (updatedDocument) {\n        setCurrentDocument(updatedDocument);\n      }\n\n      // Reload documents list\n      const docs = await storageService.listDocuments({ sortBy: 'updatedAt', sortOrder: 'desc' });\n      setDocuments(docs);\n\n      addToast({\n        type: 'success',\n        message: 'Pages reordered',\n      });\n    } catch (error) {\n      console.error('Failed to reorder pages:', error);\n      addToast({\n        type: 'error',\n        message: 'Failed to reorder pages',\n      });\n    } finally {\n      setIsLoading(false);\n      setDraggedPageIndex(null);\n      setDragOverPageIndex(null);\n    }\n  };\n\n  const handleExport = () => {\n    if (currentDocument) {\n      setCurrentView('export');\n    }\n  };\n\n  const handleOCR = () => {\n    if (currentDocument) {\n      setCurrentView('ocr');\n    }\n  };\n\n  if (!currentDocument) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-gray-50 p-6\">\n        <div className=\"text-6xl mb-4\">üìÑ</div>\n        <h2 className=\"text-xl font-semibold mb-2\">No Document Selected</h2>\n        <Button onClick={() => setCurrentView('documents')} variant=\"primary\" size=\"lg\">\n          Back to Documents\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full bg-gray-50 flex flex-col\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 p-4\">\n        <div className=\"flex items-center gap-3 mb-3\">\n          <IconButton\n            icon=\"‚Üê\"\n            onClick={() => setCurrentView('documents')}\n            title=\"Back to documents\"\n            size=\"md\"\n          />\n          <div className=\"flex-1\">\n            {isEditing ? (\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  value={documentName}\n                  onChange={(e) => setDocumentName(e.target.value)}\n                  className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  autoFocus\n                  onKeyPress={(e) => {\n                    if (e.key === 'Enter') {\n                      handleSaveName();\n                    }\n                  }}\n                />\n                <Button onClick={handleSaveName} variant=\"primary\" size=\"sm\">\n                  Save\n                </Button>\n                <Button onClick={() => {\n                  setDocumentName(currentDocument.name);\n                  setIsEditing(false);\n                }} variant=\"secondary\" size=\"sm\">\n                  Cancel\n                </Button>\n              </div>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <h2 className=\"text-lg font-semibold\">{currentDocument.name}</h2>\n                <IconButton\n                  icon=\"‚úèÔ∏è\"\n                  onClick={() => setIsEditing(true)}\n                  title=\"Edit name\"\n                  size=\"sm\"\n                />\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Document Info */}\n        <div className=\"text-sm text-gray-600 space-y-1\">\n          <div>{currentDocument.pages.length} page{currentDocument.pages.length !== 1 ? 's' : ''}</div>\n          <div>Created: {new Date(currentDocument.createdAt).toLocaleString()}</div>\n          <div>Updated: {new Date(currentDocument.updatedAt).toLocaleString()}</div>\n          {currentDocument.metadata.hasOCR && <div className=\"text-green-600\">‚úì OCR completed</div>}\n        </div>\n\n        {/* Tags */}\n        <div className=\"mt-3\">\n          <div className=\"text-sm font-medium text-gray-700 mb-2\">Tags</div>\n          <div className=\"flex flex-wrap gap-2 mb-2\">\n            {currentDocument.tags.map((tag) => (\n              <span\n                key={tag}\n                className=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs\"\n              >\n                {tag}\n                <button\n                  onClick={() => handleRemoveTag(tag)}\n                  className=\"hover:text-blue-900\"\n                >\n                  √ó\n                </button>\n              </span>\n            ))}\n          </div>\n          <div className=\"flex gap-2\">\n            <input\n              type=\"text\"\n              value={newTag}\n              onChange={(e) => setNewTag(e.target.value)}\n              placeholder=\"Add tag...\"\n              className=\"flex-1 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              onKeyPress={(e) => {\n                if (e.key === 'Enter') {\n                  handleAddTag();\n                }\n              }}\n            />\n            <Button onClick={handleAddTag} variant=\"secondary\" size=\"sm\">\n              Add\n            </Button>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-2 mt-3\">\n          {!currentDocument.metadata.hasOCR && (\n            <Button onClick={handleOCR} variant=\"secondary\" size=\"sm\" fullWidth>\n              Extract Text\n            </Button>\n          )}\n          <Button onClick={handleExport} variant=\"primary\" size=\"sm\" fullWidth>\n            Export\n          </Button>\n        </div>\n      </div>\n\n      {/* Pages Grid */}\n      <div className=\"flex-1 overflow-y-auto p-4\">\n        <div className=\"mb-3 text-sm text-gray-600\">\n          Drag and drop pages to reorder them\n        </div>\n        <div className=\"grid grid-cols-2 gap-4\">\n          {currentDocument.pages.map((page, index) => (\n            <div\n              key={page.id}\n              draggable\n              onDragStart={() => handleDragStart(index)}\n              onDragOver={(e) => handleDragOver(e, index)}\n              onDrop={(e) => handleDrop(e, index)}\n              className={`bg-white rounded-lg shadow hover:shadow-lg transition-all cursor-move ${\n                dragOverPageIndex === index && draggedPageIndex !== index\n                  ? 'ring-2 ring-blue-500'\n                  : ''\n              } ${draggedPageIndex === index ? 'opacity-50' : ''}`}\n            >\n              {/* Thumbnail */}\n              <div className=\"aspect-[3/4] bg-gray-200 relative overflow-hidden rounded-t-lg\">\n                {thumbnails.has(page.id) ? (\n                  <img\n                    src={thumbnails.get(page.id)}\n                    alt={`Page ${page.pageNumber}`}\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\n                    <span className=\"text-4xl\">üìÑ</span>\n                  </div>\n                )}\n\n                {/* Delete button */}\n                <button\n                  onClick={() => handleDeletePage(page.id)}\n                  className=\"absolute top-2 right-2 w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg transition-colors\"\n                  title=\"Delete page\"\n                >\n                  √ó\n                </button>\n\n                {/* Page number badge */}\n                <div className=\"absolute bottom-2 left-2 px-2 py-1 bg-black/70 text-white text-xs rounded\">\n                  Page {page.pageNumber}\n                </div>\n              </div>\n\n              {/* Page Info */}\n              <div className=\"p-2 text-xs text-gray-600\">\n                <div>Filter: {page.filterApplied}</div>\n                {page.ocrResult && (\n                  <div className=\"text-green-600 mt-1\">‚úì OCR available</div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Loading Overlay */}\n      {isLoading && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-4 flex items-center gap-3\">\n            <Spinner size=\"sm\" />\n            <span className=\"text-sm text-gray-700\">Processing...</span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":["StorageInfo","compact","usage","setUsage","useState","isLoading","setIsLoading","useEffect","loadStorageUsage","async","storageService","getStorageService","storageUsage","getStorageUsage","error","formatBytes","bytes","i","Math","floor","log","round","pow","jsx","className","children","quota","getUsageColor","percentage","jsxs","used","style","width","min","toFixed","DocumentsView","documents","selectedDocumentIds","setDocuments","setCurrentDocument","removeDocument","toggleDocumentSelection","clearDocumentSelection","selectAllDocuments","setCurrentView","addToast","useStore","state","list","thumbnails","setThumbnails","Map","isSelectionMode","setIsSelectionMode","isExporting","setIsExporting","exportProgress","setExportProgress","current","total","searchQuery","setSearchQuery","filteredDocuments","setFilteredDocuments","loadDocuments","length","loadThumbnails","trim","query","toLowerCase","filtered","filter","doc","name","includes","tags","some","tag","metadata","hasOCR","page","pages","ocrResult","text","docs","listDocuments","sortBy","sortOrder","type","message","newThumbnails","firstPage","url","URL","createObjectURL","thumbnailImage","set","id","forEach","revokeObjectURL","handleBulkExport","format","bulkExportService","getBulkExportService","selectedDocs","pdfOptions","pageSize","orientation","quality","includeOCR","compression","imageOptions","zipBlob","exportDocumentsAsZip","progress","filename","generateZipFilename","link","document","createElement","href","download","body","appendChild","click","removeChild","Spinner","size","Button","onClick","variant","value","onChange","e","target","placeholder","map","isSelected","handleDocumentClick","has","src","get","alt","checked","stopPropagation","docId","confirm","deleteDocument","handleDeleteDocument","title","Date","updatedAt","toLocaleDateString","handleOCRDocument","DocumentDetailView","currentDocument","isEditing","setIsEditing","documentName","setDocumentName","newTag","setNewTag","draggedPageIndex","setDraggedPageIndex","dragOverPageIndex","setDragOverPageIndex","handleSaveName","updatedDocument","updateDocument","handleAddTag","IconButton","icon","autoFocus","onKeyPress","key","createdAt","toLocaleString","t","handleRemoveTag","fullWidth","index","draggable","onDragStart","handleDragStart","onDragOver","preventDefault","handleDragOver","onDrop","dropIndex","draggedPage","splice","pageIds","p","reorderPages","getDocument","handleDrop","pageNumber","pageId","removePage","handleDeletePage","filterApplied"],"mappings":"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"}