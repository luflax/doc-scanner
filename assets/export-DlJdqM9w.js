import{r as e,j as s}from"./react-vendor-DmQDSmdE.js";import{u as a,B as t,S as r}from"./camera-BXopByFL.js";import{b as l}from"./services-B6435NxM.js";const i=()=>{const{currentDocument:i,setCurrentView:n,addToast:d}=a(e=>({currentDocument:e.documents.currentDocument,setCurrentView:e.setCurrentView,addToast:e.addToast})),[o,c]=e.useState("pdf"),[m,x]=e.useState(!1),[g,u]=e.useState(0),[h,p]=e.useState(!1),[b,j]=e.useState({pageSize:"a4",orientation:"auto",quality:"high",includeOCR:!1,compression:!0}),[y,v]=e.useState({format:"png",quality:90}),N=l(),f=async()=>{if(i){x(!0),u(0);try{let e=`${i.name}`;switch(o){case"pdf":{u(30);const s=await N.exportToPDF(i,b);u(100),e+=".pdf",N.downloadBlob(s,e),d({type:"success",message:"PDF exported successfully"});break}case"png":case"jpeg":if(1===i.pages.length){u(50);const s=await N.exportToImage(i.pages[0],{...y,format:o});u(100),e+=`.${o}`,N.downloadBlob(s,e),d({type:"success",message:`${o.toUpperCase()} exported successfully`})}else{const e=await N.exportMultipleImages(i,{...y,format:o});for(let s=0;s<e.length;s++){u((s+1)/e.length*100);const a=`${i.name}_page${s+1}.${o}`;N.downloadBlob(e[s],a)}d({type:"success",message:`${e.length} images exported successfully`})}break;case"txt":{u(50);const s=await N.exportToText(i,h);u(100),e+=h?".md":".txt",N.downloadBlob(s,e),d({type:"success",message:h?"Markdown exported successfully":"Text exported successfully"});break}}}catch(e){d({type:"error",message:e instanceof Error?e.message:"Export failed"})}finally{x(!1),u(0)}}else d({type:"error",message:"No document to export"})};return i?s.jsx("div",{className:"h-full bg-white overflow-y-auto",children:s.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:i.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[i.pages.length," page",1!==i.pages.length?"s":"",i.metadata.hasOCR&&" â€¢ OCR processed"]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{onClick:()=>c("pdf"),className:"p-4 rounded-lg border-2 transition-all "+("pdf"===o?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“„"}),s.jsx("div",{className:"font-medium",children:"PDF"}),s.jsx("div",{className:"text-xs text-gray-600",children:"Multi-page document"})]}),s.jsxs("button",{onClick:()=>c("png"),className:"p-4 rounded-lg border-2 transition-all "+("png"===o?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:"text-3xl mb-2",children:"ðŸ–¼ï¸"}),s.jsx("div",{className:"font-medium",children:"PNG"}),s.jsx("div",{className:"text-xs text-gray-600",children:"Lossless image"})]}),s.jsxs("button",{onClick:()=>c("jpeg"),className:"p-4 rounded-lg border-2 transition-all "+("jpeg"===o?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[s.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“·"}),s.jsx("div",{className:"font-medium",children:"JPEG"}),s.jsx("div",{className:"text-xs text-gray-600",children:"Compressed image"})]}),s.jsxs("button",{onClick:()=>c("txt"),className:"p-4 rounded-lg border-2 transition-all "+("txt"===o?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"),disabled:!i.metadata.hasOCR,children:[s.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“"}),s.jsx("div",{className:"font-medium",children:"Text"}),s.jsx("div",{className:"text-xs text-gray-600",children:i.metadata.hasOCR?"OCR text only":"OCR required"})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Quick Presets"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("button",{onClick:()=>{c("pdf"),j({...b,pageSize:"a4",quality:"high",includeOCR:i?.metadata.hasOCR||!1})},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸ“§ Email",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"PDF â€¢ High quality"})]}),s.jsxs("button",{onClick:()=>{c("pdf"),j({...b,pageSize:"a4",quality:"medium",includeOCR:!1})},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸ–¨ï¸ Print",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"PDF â€¢ A4 â€¢ Medium"})]}),s.jsxs("button",{onClick:()=>{c("pdf"),j({...b,pageSize:"original",quality:"original",includeOCR:i?.metadata.hasOCR||!1})},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸ’¾ Archive",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"PDF â€¢ Original"})]}),s.jsxs("button",{onClick:()=>{c("jpeg"),v({format:"jpeg",quality:80,maxDimension:1920})},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸ“± Mobile",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"JPEG â€¢ Optimized"})]}),s.jsxs("button",{onClick:()=>{c("png"),v({format:"png",quality:100})},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸŽ¨ Design",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"PNG â€¢ Lossless"})]}),i?.metadata.hasOCR&&s.jsxs("button",{onClick:()=>{c("txt"),p(!0)},className:"p-3 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:["ðŸ“ Notes",s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Markdown â€¢ Text"})]})]})]}),"pdf"===o&&s.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium mb-3",children:"PDF Options"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Page Size"}),s.jsxs("select",{value:b.pageSize,onChange:e=>j({...b,pageSize:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:"a4",children:"A4"}),s.jsx("option",{value:"letter",children:"Letter"}),s.jsx("option",{value:"legal",children:"Legal"}),s.jsx("option",{value:"original",children:"Original Size"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Orientation"}),s.jsxs("select",{value:b.orientation,onChange:e=>j({...b,orientation:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:"auto",children:"Auto"}),s.jsx("option",{value:"portrait",children:"Portrait"}),s.jsx("option",{value:"landscape",children:"Landscape"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Quality"}),s.jsxs("select",{value:b.quality,onChange:e=>j({...b,quality:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:"low",children:"Low (smaller file)"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"original",children:"Original"})]})]}),i.metadata.hasOCR&&s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:b.includeOCR,onChange:e=>j({...b,includeOCR:e.target.checked}),className:"rounded border-gray-300"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Include OCR text layer (searchable PDF)"})]})]})]}),("png"===o||"jpeg"===o)&&s.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium mb-3",children:"Image Options"}),s.jsxs("div",{className:"space-y-4",children:["jpeg"===o&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm text-gray-700 mb-2",children:["Quality: ",y.quality,"%"]}),s.jsx("input",{type:"range",min:"10",max:"100",step:"10",value:y.quality,onChange:e=>v({...y,quality:parseInt(e.target.value)}),className:"w-full"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:void 0!==y.maxDimension,onChange:e=>v({...y,maxDimension:e.target.checked?2048:void 0}),className:"rounded border-gray-300"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Limit maximum dimension"})]}),void 0!==y.maxDimension&&s.jsx("input",{type:"number",value:y.maxDimension,onChange:e=>v({...y,maxDimension:parseInt(e.target.value)}),className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Max dimension (px)"})]})]})]}),"txt"===o&&s.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium mb-3",children:"Text Options"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:h,onChange:e=>p(e.target.checked),className:"rounded border-gray-300"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Export as Markdown (formatted with headings and metadata)"})]}),s.jsx("div",{className:"text-xs text-gray-600 bg-white p-3 rounded border border-gray-200",children:h?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Markdown format:"})," Includes document title, creation date, page headings, and confidence scores. Perfect for documentation or note-taking apps."]}):s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"Plain text format:"})," Simple text output with page separators. Compatible with any text editor."]})})]})]}),!m&&s.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium mb-3",children:"Document Preview"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.pages.slice(0,6).map(e=>s.jsxs("div",{className:"aspect-[3/4] bg-gray-200 rounded overflow-hidden relative",children:[s.jsx("img",{src:URL.createObjectURL(e.thumbnailImage),alt:`Page ${e.pageNumber}`,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-black/70 text-white text-xs rounded",children:e.pageNumber})]},e.id)),i.pages.length>6&&s.jsxs("div",{className:"aspect-[3/4] bg-gray-300 rounded flex items-center justify-center text-gray-600 text-sm",children:["+",i.pages.length-6," more"]})]})]}),m&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Exporting..."}),s.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(g),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${g}%`}})})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(t,{onClick:f,disabled:m,variant:"primary",size:"lg",className:"flex-1",children:m?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx(r,{size:"sm"}),"Exporting..."]}):`Export as ${o.toUpperCase()}`}),void 0!==navigator.share&&s.jsx(t,{onClick:async()=>{if(i){x(!0);try{let e,s;switch(o){case"pdf":e=await N.exportToPDF(i,b),s=`${i.name}.pdf`;break;case"png":case"jpeg":if(1!==i.pages.length)return void d({type:"warning",message:"Can only share single-page documents. Export multiple pages separately."});e=await N.exportToImage(i.pages[0],{...y,format:o}),s=`${i.name}.${o}`;break;case"txt":e=await N.exportToText(i,h),s=`${i.name}.${h?"md":"txt"}`;break;default:throw new Error("Invalid format")}await N.share(e,s,i.name),d({type:"success",message:"Shared successfully"})}catch(e){e instanceof Error&&e.message.includes("not supported")?f():d({type:"error",message:"Share failed"})}finally{x(!1)}}},disabled:m,variant:"secondary",size:"lg",children:"ðŸ“¤ Share"})]})]})}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-gray-50 p-6",children:[s.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¤"}),s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No Document Selected"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6 text-center max-w-md",children:"Select a document from your library to export it."}),s.jsx(t,{onClick:()=>n("documents"),variant:"primary",size:"lg",children:"Go to Documents"})]})};export{i as E};
