{"version":3,"file":"camera-BXopByFL.js","sources":["../../src/constants/filters.ts","../../src/store/index.ts","../../src/components/common/Button.tsx","../../src/components/common/IconButton.tsx","../../src/components/common/Spinner.tsx","../../src/components/camera/CameraView.tsx","../../src/hooks/useCameraStream.ts"],"sourcesContent":["import type { FilterPreset, EnhancementOptions } from '@/types';\n\ninterface EnhancementStep {\n  type: string;\n  [key: string]: any;\n}\n\ninterface EnhancementPipeline {\n  steps: EnhancementStep[];\n}\n\nexport const FILTER_PRESETS: Record<FilterPreset, EnhancementPipeline> = {\n  original: {\n    steps: [],\n  },\n  document: {\n    steps: [\n      { type: 'grayscale' },\n      { type: 'adaptiveThreshold', blockSize: 11, C: 2 },\n      { type: 'denoise', strength: 3 },\n      { type: 'sharpen', amount: 0.5 },\n    ],\n  },\n  grayscale: {\n    steps: [\n      { type: 'grayscale' },\n      { type: 'contrast', value: 10 },\n      { type: 'sharpen', amount: 0.3 },\n    ],\n  },\n  magic: {\n    steps: [\n      { type: 'autoWhiteBalance' },\n      { type: 'autoContrast' },\n      { type: 'shadowRecovery', amount: 30 },\n      { type: 'sharpen', amount: 0.4 },\n      { type: 'vibrance', amount: 15 },\n    ],\n  },\n  whiteboard: {\n    steps: [\n      { type: 'whiteBalance', temperature: -10 },\n      { type: 'brightness', value: 20 },\n      { type: 'contrast', value: 40 },\n      { type: 'saturation', value: -30 },\n      { type: 'sharpen', amount: 0.6 },\n    ],\n  },\n  book: {\n    steps: [\n      { type: 'grayscale' },\n      { type: 'contrast', value: 15 },\n      { type: 'brightness', value: 10 },\n      { type: 'sharpen', amount: 0.4 },\n    ],\n  },\n  receipt: {\n    steps: [\n      { type: 'grayscale' },\n      { type: 'adaptiveThreshold', blockSize: 15, C: 5 },\n      { type: 'denoise', strength: 5 },\n      { type: 'sharpen', amount: 0.6 },\n    ],\n  },\n  photo: {\n    steps: [\n      { type: 'autoWhiteBalance' },\n      { type: 'contrast', value: 5 },\n      { type: 'saturation', value: 10 },\n      { type: 'sharpen', amount: 0.2 },\n    ],\n  },\n  blueprint: {\n    steps: [\n      { type: 'invert' },\n      { type: 'contrast', value: 20 },\n      { type: 'sharpen', amount: 0.5 },\n    ],\n  },\n};\n\nexport const DEFAULT_ENHANCEMENT_OPTIONS: EnhancementOptions = {\n  brightness: 0,\n  contrast: 0,\n  saturation: 0,\n  sharpness: 0,\n  gamma: 1.0,\n  shadows: 0,\n  highlights: 0,\n  temperature: 0,\n};\n\nexport const FILTER_LABELS: Record<FilterPreset, string> = {\n  original: 'Original',\n  document: 'Document',\n  grayscale: 'Grayscale',\n  magic: 'Magic Color',\n  whiteboard: 'Whiteboard',\n  book: 'Book',\n  receipt: 'Receipt',\n  photo: 'Photo',\n  blueprint: 'Blueprint',\n};\n\nexport interface FilterPresetInfo {\n  id: FilterPreset;\n  name: string;\n  description: string;\n  icon: string;\n}\n\nexport const FILTER_PRESET_INFO: FilterPresetInfo[] = [\n  {\n    id: 'original',\n    name: 'Original',\n    description: 'No filter applied',\n    icon: 'ðŸ“„',\n  },\n  {\n    id: 'document',\n    name: 'Document',\n    description: 'High contrast B&W',\n    icon: 'ðŸ“ƒ',\n  },\n  {\n    id: 'grayscale',\n    name: 'Grayscale',\n    description: 'Black and white',\n    icon: 'â¬œ',\n  },\n  {\n    id: 'magic',\n    name: 'Magic',\n    description: 'Auto-enhanced',\n    icon: 'âœ¨',\n  },\n  {\n    id: 'whiteboard',\n    name: 'Whiteboard',\n    description: 'For whiteboards',\n    icon: 'ðŸ–Šï¸',\n  },\n  {\n    id: 'book',\n    name: 'Book',\n    description: 'For book pages',\n    icon: 'ðŸ“–',\n  },\n  {\n    id: 'receipt',\n    name: 'Receipt',\n    description: 'High contrast',\n    icon: 'ðŸ§¾',\n  },\n  {\n    id: 'photo',\n    name: 'Photo',\n    description: 'Color preserved',\n    icon: 'ðŸ–¼ï¸',\n  },\n  {\n    id: 'blueprint',\n    name: 'Blueprint',\n    description: 'Inverted colors',\n    icon: 'ðŸ“',\n  },\n];\n","import { create } from 'zustand';\nimport type {\n  CameraCapabilities,\n  DetectedEdge,\n  Point,\n  FilterPreset,\n  EnhancementOptions,\n  OCRResult,\n  Document,\n  ViewType,\n  Toast,\n} from '@/types';\nimport { DEFAULT_ENHANCEMENT_OPTIONS } from '@/constants/filters';\n\ninterface CameraState {\n  isInitialized: boolean;\n  isCapturing: boolean;\n  stream: MediaStream | null;\n  capabilities: CameraCapabilities | null;\n  error: Error | null;\n}\n\ninterface ScanSessionState {\n  isActive: boolean;\n  currentImage: ImageData | null;\n  detectedEdges: DetectedEdge | null;\n  adjustedCorners: Point[] | null;\n  processedImage: ImageData | null;\n  selectedFilter: FilterPreset;\n  enhancementOptions: EnhancementOptions;\n}\n\ninterface OCRState {\n  isInitialized: boolean;\n  isProcessing: boolean;\n  progress: number;\n  result: OCRResult | null;\n  selectedLanguages: string[];\n}\n\ninterface DocumentsState {\n  list: Document[];\n  currentDocument: Document | null;\n  isLoading: boolean;\n  selectedDocumentIds: string[];\n}\n\ninterface UIState {\n  currentView: ViewType;\n  isProcessing: boolean;\n  toasts: Toast[];\n  modalOpen: string | null;\n}\n\ninterface AppState {\n  camera: CameraState;\n  scanSession: ScanSessionState;\n  ocr: OCRState;\n  documents: DocumentsState;\n  ui: UIState;\n\n  // Camera actions\n  setCameraInitialized: (initialized: boolean) => void;\n  setCameraStream: (stream: MediaStream | null) => void;\n  setCameraCapabilities: (capabilities: CameraCapabilities | null) => void;\n  setCameraError: (error: Error | null) => void;\n  setCapturing: (capturing: boolean) => void;\n\n  // Scan session actions\n  startScanSession: (image: ImageData) => void;\n  setDetectedEdges: (edges: DetectedEdge | null) => void;\n  setAdjustedCorners: (corners: Point[] | null) => void;\n  setProcessedImage: (image: ImageData | null) => void;\n  setSelectedFilter: (filter: FilterPreset) => void;\n  setEnhancementOptions: (options: EnhancementOptions) => void;\n  resetScanSession: () => void;\n\n  // OCR actions\n  setOCRInitialized: (initialized: boolean) => void;\n  setOCRProcessing: (processing: boolean) => void;\n  setOCRProgress: (progress: number) => void;\n  setOCRResult: (result: OCRResult | null) => void;\n  setSelectedLanguages: (languages: string[]) => void;\n\n  // Document actions\n  setDocuments: (documents: Document[]) => void;\n  setCurrentDocument: (document: Document | null) => void;\n  setDocumentsLoading: (loading: boolean) => void;\n  addDocument: (document: Document) => void;\n  removeDocument: (id: string) => void;\n  toggleDocumentSelection: (id: string) => void;\n  clearDocumentSelection: () => void;\n  selectAllDocuments: () => void;\n\n  // UI actions\n  setCurrentView: (view: ViewType) => void;\n  setProcessing: (processing: boolean) => void;\n  addToast: (toast: Omit<Toast, 'id'>) => void;\n  removeToast: (id: string) => void;\n  setModalOpen: (modal: string | null) => void;\n}\n\nexport const useStore = create<AppState>((set) => ({\n  // Initial state\n  camera: {\n    isInitialized: false,\n    isCapturing: false,\n    stream: null,\n    capabilities: null,\n    error: null,\n  },\n  scanSession: {\n    isActive: false,\n    currentImage: null,\n    detectedEdges: null,\n    adjustedCorners: null,\n    processedImage: null,\n    selectedFilter: 'original',\n    enhancementOptions: DEFAULT_ENHANCEMENT_OPTIONS,\n  },\n  ocr: {\n    isInitialized: false,\n    isProcessing: false,\n    progress: 0,\n    result: null,\n    selectedLanguages: ['eng'],\n  },\n  documents: {\n    list: [],\n    currentDocument: null,\n    isLoading: false,\n    selectedDocumentIds: [],\n  },\n  ui: {\n    currentView: 'camera',\n    isProcessing: false,\n    toasts: [],\n    modalOpen: null,\n  },\n\n  // Camera actions\n  setCameraInitialized: (initialized) =>\n    set((state) => ({\n      camera: { ...state.camera, isInitialized: initialized },\n    })),\n  setCameraStream: (stream) =>\n    set((state) => ({\n      camera: { ...state.camera, stream },\n    })),\n  setCameraCapabilities: (capabilities) =>\n    set((state) => ({\n      camera: { ...state.camera, capabilities },\n    })),\n  setCameraError: (error) =>\n    set((state) => ({\n      camera: { ...state.camera, error },\n    })),\n  setCapturing: (capturing) =>\n    set((state) => ({\n      camera: { ...state.camera, isCapturing: capturing },\n    })),\n\n  // Scan session actions\n  startScanSession: (image) =>\n    set({\n      scanSession: {\n        isActive: true,\n        currentImage: image,\n        detectedEdges: null,\n        adjustedCorners: null,\n        processedImage: null,\n        selectedFilter: 'original',\n        enhancementOptions: DEFAULT_ENHANCEMENT_OPTIONS,\n      },\n    }),\n  setDetectedEdges: (edges) =>\n    set((state) => ({\n      scanSession: { ...state.scanSession, detectedEdges: edges },\n    })),\n  setAdjustedCorners: (corners) =>\n    set((state) => ({\n      scanSession: { ...state.scanSession, adjustedCorners: corners },\n    })),\n  setProcessedImage: (image) =>\n    set((state) => ({\n      scanSession: { ...state.scanSession, processedImage: image },\n    })),\n  setSelectedFilter: (filter) =>\n    set((state) => ({\n      scanSession: { ...state.scanSession, selectedFilter: filter },\n    })),\n  setEnhancementOptions: (options) =>\n    set((state) => ({\n      scanSession: { ...state.scanSession, enhancementOptions: options },\n    })),\n  resetScanSession: () =>\n    set({\n      scanSession: {\n        isActive: false,\n        currentImage: null,\n        detectedEdges: null,\n        adjustedCorners: null,\n        processedImage: null,\n        selectedFilter: 'original',\n        enhancementOptions: DEFAULT_ENHANCEMENT_OPTIONS,\n      },\n    }),\n\n  // OCR actions\n  setOCRInitialized: (initialized) =>\n    set((state) => ({\n      ocr: { ...state.ocr, isInitialized: initialized },\n    })),\n  setOCRProcessing: (processing) =>\n    set((state) => ({\n      ocr: { ...state.ocr, isProcessing: processing },\n    })),\n  setOCRProgress: (progress) =>\n    set((state) => ({\n      ocr: { ...state.ocr, progress },\n    })),\n  setOCRResult: (result) =>\n    set((state) => ({\n      ocr: { ...state.ocr, result },\n    })),\n  setSelectedLanguages: (languages) =>\n    set((state) => ({\n      ocr: { ...state.ocr, selectedLanguages: languages },\n    })),\n\n  // Document actions\n  setDocuments: (documents) =>\n    set((state) => ({\n      documents: { ...state.documents, list: documents },\n    })),\n  setCurrentDocument: (document) =>\n    set((state) => ({\n      documents: { ...state.documents, currentDocument: document },\n    })),\n  setDocumentsLoading: (loading) =>\n    set((state) => ({\n      documents: { ...state.documents, isLoading: loading },\n    })),\n  addDocument: (document) =>\n    set((state) => ({\n      documents: {\n        ...state.documents,\n        list: [document, ...state.documents.list],\n      },\n    })),\n  removeDocument: (id) =>\n    set((state) => ({\n      documents: {\n        ...state.documents,\n        list: state.documents.list.filter((doc) => doc.id !== id),\n        selectedDocumentIds: state.documents.selectedDocumentIds.filter(\n          (docId) => docId !== id\n        ),\n      },\n    })),\n  toggleDocumentSelection: (id) =>\n    set((state) => {\n      const isSelected = state.documents.selectedDocumentIds.includes(id);\n      return {\n        documents: {\n          ...state.documents,\n          selectedDocumentIds: isSelected\n            ? state.documents.selectedDocumentIds.filter((docId) => docId !== id)\n            : [...state.documents.selectedDocumentIds, id],\n        },\n      };\n    }),\n  clearDocumentSelection: () =>\n    set((state) => ({\n      documents: {\n        ...state.documents,\n        selectedDocumentIds: [],\n      },\n    })),\n  selectAllDocuments: () =>\n    set((state) => ({\n      documents: {\n        ...state.documents,\n        selectedDocumentIds: state.documents.list.map((doc) => doc.id),\n      },\n    })),\n\n  // UI actions\n  setCurrentView: (view) =>\n    set((state) => ({\n      ui: { ...state.ui, currentView: view },\n    })),\n  setProcessing: (processing) =>\n    set((state) => ({\n      ui: { ...state.ui, isProcessing: processing },\n    })),\n  addToast: (toast) =>\n    set((state) => ({\n      ui: {\n        ...state.ui,\n        toasts: [\n          ...state.ui.toasts,\n          { ...toast, id: Math.random().toString(36).substr(2, 9) },\n        ],\n      },\n    })),\n  removeToast: (id) =>\n    set((state) => ({\n      ui: {\n        ...state.ui,\n        toasts: state.ui.toasts.filter((t) => t.id !== id),\n      },\n    })),\n  setModalOpen: (modal) =>\n    set((state) => ({\n      ui: { ...state.ui, modalOpen: modal },\n    })),\n}));\n","import React from 'react';\n\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'primary' | 'secondary' | 'outline';\n  size?: 'sm' | 'md' | 'lg';\n  fullWidth?: boolean;\n  children: React.ReactNode;\n}\n\nexport const Button: React.FC<ButtonProps> = ({\n  variant = 'primary',\n  size = 'md',\n  fullWidth = false,\n  className = '',\n  children,\n  ...props\n}) => {\n  const baseClasses = 'btn font-medium transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed';\n\n  const variantClasses = {\n    primary: 'btn-primary',\n    secondary: 'btn-secondary',\n    outline: 'border-2 border-primary-600 text-primary-600 hover:bg-primary-50 active:bg-primary-100',\n  };\n\n  const sizeClasses = {\n    sm: 'px-3 py-1.5 text-sm',\n    md: 'px-4 py-2 text-base',\n    lg: 'px-6 py-3 text-lg',\n  };\n\n  const widthClass = fullWidth ? 'w-full' : '';\n\n  return (\n    <button\n      className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${widthClass} ${className}`}\n      {...props}\n    >\n      {children}\n    </button>\n  );\n};\n","import React from 'react';\n\ninterface IconButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  icon: React.ReactNode;\n  label?: string;\n  size?: 'sm' | 'md' | 'lg';\n}\n\nexport const IconButton: React.FC<IconButtonProps> = ({\n  icon,\n  label,\n  size = 'md',\n  className = '',\n  ...props\n}) => {\n  const sizeClasses = {\n    sm: 'p-2',\n    md: 'p-3',\n    lg: 'p-4',\n  };\n\n  return (\n    <button\n      className={`btn-icon ${sizeClasses[size]} ${className}`}\n      aria-label={label}\n      title={label}\n      {...props}\n    >\n      {icon}\n    </button>\n  );\n};\n","import React from 'react';\n\ninterface SpinnerProps {\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nexport const Spinner: React.FC<SpinnerProps> = ({ size = 'md', className = '' }) => {\n  const sizeClasses = {\n    sm: 'w-4 h-4',\n    md: 'w-8 h-8',\n    lg: 'w-12 h-12',\n  };\n\n  return (\n    <div className={`flex items-center justify-center ${className}`}>\n      <div\n        className={`${sizeClasses[size]} border-4 border-gray-200 border-t-primary-600 rounded-full animate-spin`}\n      />\n    </div>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { useStore } from '@/store';\nimport { useCameraStream } from '@/hooks/useCameraStream';\nimport { Button } from '@/components/common/Button';\nimport { IconButton } from '@/components/common/IconButton';\nimport { Spinner } from '@/components/common/Spinner';\n\nexport const CameraView: React.FC = () => {\n  const { addToast, setCameraCapabilities, setCurrentView, startScanSession } = useStore((state) => ({\n    addToast: state.addToast,\n    setCameraCapabilities: state.setCameraCapabilities,\n    setCurrentView: state.setCurrentView,\n    startScanSession: state.startScanSession,\n  }));\n\n  const {\n    videoRef,\n    isInitialized,\n    isLoading,\n    error,\n    capabilities,\n    facingMode,\n    initialize,\n    switchCamera,\n    capturePhoto,\n  } = useCameraStream({\n    onError: (err) => {\n      addToast({\n        type: 'error',\n        message: err.message || 'Failed to access camera',\n      });\n    },\n    onInitialized: () => {\n      addToast({\n        type: 'success',\n        message: 'Camera initialized successfully',\n      });\n    },\n  });\n\n  // Update capabilities in store\n  useEffect(() => {\n    if (capabilities) {\n      setCameraCapabilities(capabilities);\n    }\n  }, [capabilities, setCameraCapabilities]);\n\n  const handleCapture = async () => {\n    const imageData = await capturePhoto();\n    if (imageData) {\n      startScanSession(imageData);\n      setCurrentView('crop');\n\n      addToast({\n        type: 'success',\n        message: 'Image captured successfully',\n      });\n    }\n  };\n\n  const handleSwitchCamera = async () => {\n    try {\n      await switchCamera();\n      addToast({\n        type: 'success',\n        message: `Switched to ${facingMode === 'environment' ? 'front' : 'back'} camera`,\n      });\n    } catch (err) {\n      addToast({\n        type: 'error',\n        message: 'Failed to switch camera',\n      });\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-black\">\n        <Spinner size=\"lg\" className=\"mb-4\" />\n        <p className=\"text-white text-sm\">Initializing camera...</p>\n      </div>\n    );\n  }\n\n  if (error || (!isInitialized && !isLoading)) {\n    return (\n      <div className=\"flex flex-col items-center justify-center h-full bg-gray-100 p-6\">\n        <div className=\"text-6xl mb-4\">ðŸ“·</div>\n        <h2 className=\"text-xl font-semibold mb-2\">Camera Access Required</h2>\n        {error && (\n          <p className=\"text-sm text-red-600 mb-4 text-center max-w-md\">{error.message}</p>\n        )}\n        <p className=\"text-sm text-gray-600 mb-6 text-center max-w-md\">\n          This app needs access to your camera to scan documents. Click the button below to\n          grant permission.\n        </p>\n        <Button onClick={initialize} variant=\"primary\" size=\"lg\">\n          Enable Camera\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative w-full h-full bg-black\">\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        muted\n        className=\"w-full h-full object-cover\"\n      />\n\n      {/* Top controls */}\n      <div className=\"absolute top-0 left-0 right-0 p-4\">\n        <div className=\"flex justify-end\">\n          <IconButton\n            icon={<span className=\"text-xl\">ðŸ”„</span>}\n            onClick={handleSwitchCamera}\n            className=\"bg-black/50 text-white hover:bg-black/70\"\n            label=\"Switch camera\"\n          />\n        </div>\n      </div>\n\n      {/* Camera controls overlay */}\n      <div className=\"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent\">\n        <div className=\"flex items-center justify-center\">\n          <Button\n            onClick={handleCapture}\n            variant=\"primary\"\n            size=\"lg\"\n            className=\"rounded-full w-16 h-16 p-0\"\n          >\n            <span className=\"text-2xl\">ðŸ“¸</span>\n          </Button>\n        </div>\n      </div>\n\n      {/* Guide frame overlay */}\n      <div className=\"absolute inset-0 pointer-events-none\">\n        <div className=\"w-full h-full flex items-center justify-center p-8\">\n          <div className=\"border-2 border-white border-dashed rounded-lg w-full max-w-md aspect-document opacity-50\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n","import { useEffect, useRef, useState } from 'react';\nimport { cameraService } from '@/services/CameraService';\nimport type { CameraCapabilities } from '@/types';\n\ninterface UseCameraStreamOptions {\n  autoStart?: boolean;\n  facingMode?: 'environment' | 'user';\n  onError?: (error: Error) => void;\n  onInitialized?: (stream: MediaStream) => void;\n}\n\nexport const useCameraStream = (options: UseCameraStreamOptions = {}) => {\n  const { autoStart = false, facingMode = 'environment', onError, onInitialized } = options;\n\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [capabilities, setCapabilities] = useState<CameraCapabilities | null>(null);\n\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n\n  const initialize = async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const mediaStream = await cameraService.initialize({ facingMode });\n      setStream(mediaStream);\n      setIsInitialized(true);\n\n      // Get capabilities\n      const caps = cameraService.getCapabilities();\n      setCapabilities(caps);\n\n      onInitialized?.(mediaStream);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to initialize camera');\n      setError(error);\n      onError?.(error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const switchCamera = async () => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const newStream = await cameraService.switchCamera();\n      setStream(newStream);\n\n      // Update capabilities\n      const caps = cameraService.getCapabilities();\n      setCapabilities(caps);\n\n      onInitialized?.(newStream);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to switch camera');\n      setError(error);\n      onError?.(error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const capturePhoto = async (): Promise<ImageData | null> => {\n    if (!videoRef.current || !stream) {\n      setError(new Error('Camera not ready'));\n      return null;\n    }\n\n    try {\n      return await cameraService.capturePhoto(videoRef.current);\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to capture photo');\n      setError(error);\n      onError?.(error);\n      return null;\n    }\n  };\n\n  const setZoom = async (level: number) => {\n    try {\n      await cameraService.setZoom(level);\n    } catch (err) {\n      console.error('Zoom failed:', err);\n    }\n  };\n\n  const toggleFlash = async (enabled: boolean) => {\n    try {\n      await cameraService.toggleFlash(enabled);\n    } catch (err) {\n      console.error('Flash toggle failed:', err);\n    }\n  };\n\n  const dispose = () => {\n    cameraService.dispose();\n    setStream(null);\n    setIsInitialized(false);\n    setCapabilities(null);\n  };\n\n  // Attach stream to video element when both are available\n  useEffect(() => {\n    if (stream && videoRef.current) {\n      videoRef.current.srcObject = stream;\n    }\n  }, [stream]);\n\n  // Auto-start if requested\n  useEffect(() => {\n    if (autoStart) {\n      initialize();\n    }\n\n    // Cleanup on unmount\n    return () => {\n      dispose();\n    };\n  }, []); // Only run once on mount\n\n  return {\n    // State\n    stream,\n    isInitialized,\n    isLoading,\n    error,\n    capabilities,\n    videoRef,\n\n    // Actions\n    initialize,\n    switchCamera,\n    capturePhoto,\n    setZoom,\n    toggleFlash,\n    dispose,\n\n    // Current facing mode\n    facingMode: cameraService.getCurrentFacingMode(),\n  };\n};\n"],"names":["DEFAULT_ENHANCEMENT_OPTIONS","brightness","contrast","saturation","sharpness","gamma","shadows","highlights","temperature","FILTER_PRESET_INFO","id","name","description","icon","useStore","create","set","camera","isInitialized","isCapturing","stream","capabilities","error","scanSession","isActive","currentImage","detectedEdges","adjustedCorners","processedImage","selectedFilter","enhancementOptions","ocr","isProcessing","progress","result","selectedLanguages","documents","list","currentDocument","isLoading","selectedDocumentIds","ui","currentView","toasts","modalOpen","setCameraInitialized","initialized","state","setCameraStream","setCameraCapabilities","setCameraError","setCapturing","capturing","startScanSession","image","setDetectedEdges","edges","setAdjustedCorners","corners","setProcessedImage","setSelectedFilter","filter","setEnhancementOptions","options","resetScanSession","setOCRInitialized","setOCRProcessing","processing","setOCRProgress","setOCRResult","setSelectedLanguages","languages","setDocuments","setCurrentDocument","document","setDocumentsLoading","loading","addDocument","removeDocument","doc","docId","toggleDocumentSelection","isSelected","includes","clearDocumentSelection","selectAllDocuments","map","setCurrentView","view","setProcessing","addToast","toast","Math","random","toString","substr","removeToast","t","setModalOpen","modal","Button","variant","size","fullWidth","className","children","props","widthClass","jsx","primary","secondary","outline","sm","md","lg","IconButton","label","title","Spinner","CameraView","videoRef","facingMode","initialize","switchCamera","capturePhoto","autoStart","onError","onInitialized","setStream","useState","setIsInitialized","setIsLoading","setError","setCapabilities","useRef","async","mediaStream","cameraService","caps","getCapabilities","err","Error","dispose","useEffect","current","srcObject","newStream","setZoom","level","toggleFlash","enabled","getCurrentFacingMode","useCameraStream","type","message","jsxs","onClick","ref","autoPlay","playsInline","muted","imageData"],"mappings":"kJAiFO,MAAMA,EAAkD,CAC7DC,WAAY,EACZC,SAAU,EACVC,WAAY,EACZC,UAAW,EACXC,MAAO,EACPC,QAAS,EACTC,WAAY,EACZC,YAAa,GAsBFC,EAAyC,CACpD,CACEC,GAAI,WACJC,KAAM,WACNC,YAAa,oBACbC,KAAM,MAER,CACEH,GAAI,WACJC,KAAM,WACNC,YAAa,oBACbC,KAAM,MAER,CACEH,GAAI,YACJC,KAAM,YACNC,YAAa,kBACbC,KAAM,KAER,CACEH,GAAI,QACJC,KAAM,QACNC,YAAa,gBACbC,KAAM,KAER,CACEH,GAAI,aACJC,KAAM,aACNC,YAAa,kBACbC,KAAM,OAER,CACEH,GAAI,OACJC,KAAM,OACNC,YAAa,iBACbC,KAAM,MAER,CACEH,GAAI,UACJC,KAAM,UACNC,YAAa,gBACbC,KAAM,MAER,CACEH,GAAI,QACJC,KAAM,QACNC,YAAa,kBACbC,KAAM,OAER,CACEH,GAAI,YACJC,KAAM,YACNC,YAAa,kBACbC,KAAM,OC9DGC,EAAWC,EAAkBC,IAAA,CAExCC,OAAQ,CACNC,eAAe,EACfC,aAAa,EACbC,OAAQ,KACRC,aAAc,KACdC,MAAO,MAETC,YAAa,CACXC,UAAU,EACVC,aAAc,KACdC,cAAe,KACfC,gBAAiB,KACjBC,eAAgB,KAChBC,eAAgB,WAChBC,mBAAoB9B,GAEtB+B,IAAK,CACHb,eAAe,EACfc,cAAc,EACdC,SAAU,EACVC,OAAQ,KACRC,kBAAmB,CAAC,QAEtBC,UAAW,CACTC,KAAM,GACNC,gBAAiB,KACjBC,WAAW,EACXC,oBAAqB,IAEvBC,GAAI,CACFC,YAAa,SACbV,cAAc,EACdW,OAAQ,GACRC,UAAW,MAIbC,qBAAuBC,GACrB9B,EAAK+B,IAAA,CACH9B,OAAQ,IAAK8B,EAAM9B,OAAQC,cAAe4B,MAE9CE,gBAAkB5B,GAChBJ,EAAK+B,IAAA,CACH9B,OAAQ,IAAK8B,EAAM9B,OAAQG,aAE/B6B,sBAAwB5B,GACtBL,EAAK+B,IAAA,CACH9B,OAAQ,IAAK8B,EAAM9B,OAAQI,mBAE/B6B,eAAiB5B,GACfN,EAAK+B,IAAA,CACH9B,OAAQ,IAAK8B,EAAM9B,OAAQK,YAE/B6B,aAAeC,GACbpC,EAAK+B,IAAA,CACH9B,OAAQ,IAAK8B,EAAM9B,OAAQE,YAAaiC,MAI5CC,iBAAmBC,GACjBtC,EAAI,CACFO,YAAa,CACXC,UAAU,EACVC,aAAc6B,EACd5B,cAAe,KACfC,gBAAiB,KACjBC,eAAgB,KAChBC,eAAgB,WAChBC,mBAAoB9B,KAG1BuD,iBAAmBC,GACjBxC,EAAK+B,IAAA,CACHxB,YAAa,IAAKwB,EAAMxB,YAAaG,cAAe8B,MAExDC,mBAAqBC,GACnB1C,EAAK+B,IAAA,CACHxB,YAAa,IAAKwB,EAAMxB,YAAaI,gBAAiB+B,MAE1DC,kBAAoBL,GAClBtC,EAAK+B,IAAA,CACHxB,YAAa,IAAKwB,EAAMxB,YAAaK,eAAgB0B,MAEzDM,kBAAoBC,GAClB7C,EAAK+B,IAAA,CACHxB,YAAa,IAAKwB,EAAMxB,YAAaM,eAAgBgC,MAEzDC,sBAAwBC,GACtB/C,EAAK+B,IAAA,CACHxB,YAAa,IAAKwB,EAAMxB,YAAaO,mBAAoBiC,MAE7DC,iBAAkB,IAChBhD,EAAI,CACFO,YAAa,CACXC,UAAU,EACVC,aAAc,KACdC,cAAe,KACfC,gBAAiB,KACjBC,eAAgB,KAChBC,eAAgB,WAChBC,mBAAoB9B,KAK1BiE,kBAAoBnB,GAClB9B,EAAK+B,IAAA,CACHhB,IAAK,IAAKgB,EAAMhB,IAAKb,cAAe4B,MAExCoB,iBAAmBC,GACjBnD,EAAK+B,IAAA,CACHhB,IAAK,IAAKgB,EAAMhB,IAAKC,aAAcmC,MAEvCC,eAAiBnC,GACfjB,EAAK+B,IAAA,CACHhB,IAAK,IAAKgB,EAAMhB,IAAKE,eAEzBoC,aAAenC,GACblB,EAAK+B,IAAA,CACHhB,IAAK,IAAKgB,EAAMhB,IAAKG,aAEzBoC,qBAAuBC,GACrBvD,EAAK+B,IAAA,CACHhB,IAAK,IAAKgB,EAAMhB,IAAKI,kBAAmBoC,MAI5CC,aAAepC,GACbpB,EAAK+B,IAAA,CACHX,UAAW,IAAKW,EAAMX,UAAWC,KAAMD,MAE3CqC,mBAAqBC,GACnB1D,EAAK+B,IAAA,CACHX,UAAW,IAAKW,EAAMX,UAAWE,gBAAiBoC,MAEtDC,oBAAsBC,GACpB5D,EAAK+B,IAAA,CACHX,UAAW,IAAKW,EAAMX,UAAWG,UAAWqC,MAEhDC,YAAcH,GACZ1D,EAAK+B,IAAA,CACHX,UAAW,IACNW,EAAMX,UACTC,KAAM,CAACqC,KAAa3B,EAAMX,UAAUC,UAG1CyC,eAAiBpE,GACfM,EAAK+B,IAAA,CACHX,UAAW,IACNW,EAAMX,UACTC,KAAMU,EAAMX,UAAUC,KAAKwB,OAAQkB,GAAQA,EAAIrE,KAAOA,GACtD8B,oBAAqBO,EAAMX,UAAUI,oBAAoBqB,OACtDmB,GAAUA,IAAUtE,OAI7BuE,wBAA0BvE,GACxBM,EAAK+B,IACH,MAAMmC,EAAanC,EAAMX,UAAUI,oBAAoB2C,SAASzE,GAChE,MAAO,CACL0B,UAAW,IACNW,EAAMX,UACTI,oBAAqB0C,EACjBnC,EAAMX,UAAUI,oBAAoBqB,OAAQmB,GAAUA,IAAUtE,GAChE,IAAIqC,EAAMX,UAAUI,oBAAqB9B,OAIrD0E,uBAAwB,IACtBpE,EAAK+B,IAAA,CACHX,UAAW,IACNW,EAAMX,UACTI,oBAAqB,OAG3B6C,mBAAoB,IAClBrE,EAAK+B,IAAA,CACHX,UAAW,IACNW,EAAMX,UACTI,oBAAqBO,EAAMX,UAAUC,KAAKiD,IAAKP,GAAQA,EAAIrE,QAKjE6E,eAAiBC,GACfxE,EAAK+B,IAAA,CACHN,GAAI,IAAKM,EAAMN,GAAIC,YAAa8C,MAEpCC,cAAgBtB,GACdnD,EAAK+B,IAAA,CACHN,GAAI,IAAKM,EAAMN,GAAIT,aAAcmC,MAErCuB,SAAWC,GACT3E,EAAK+B,IAAA,CACHN,GAAI,IACCM,EAAMN,GACTE,OAAQ,IACHI,EAAMN,GAAGE,OACZ,IAAKgD,EAAOjF,GAAIkF,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,SAI7DC,YAActF,GACZM,EAAK+B,IAAA,CACHN,GAAI,IACCM,EAAMN,GACTE,OAAQI,EAAMN,GAAGE,OAAOkB,OAAQoC,GAAMA,EAAEvF,KAAOA,OAGrDwF,aAAeC,GACbnF,EAAK+B,IAAA,CACHN,GAAI,IAAKM,EAAMN,GAAIG,UAAWuD,SClTvBC,EAAgC,EAC3CC,UAAU,UACVC,OAAO,KACPC,aAAY,EACZC,YAAY,GACZC,cACGC,MAEH,MAcMC,EAAaJ,EAAY,SAAW,GAE1C,OACEK,EAAAA,IAAC,SAAA,CACCJ,UAAW,+GAhBQ,CACrBK,QAAS,cACTC,UAAW,gBACXC,QAAS,0FAaqCV,MAV5B,CAClBW,GAAI,sBACJC,GAAI,sBACJC,GAAI,qBAOkEZ,MAASK,KAAcH,OACvFE,EAEHD,cC9BMU,EAAwC,EACnDtG,OACAuG,QACAd,OAAO,KACPE,YAAY,MACTE,KASDE,EAAAA,IAAC,SAAA,CACCJ,UAAW,YARK,CAClBQ,GAAI,MACJC,GAAI,MACJC,GAAI,OAKiCZ,MAASE,IAC5C,aAAYY,EACZC,MAAOD,KACHV,EAEHD,SAAA5F,ICrBMyG,EAAkC,EAAGhB,OAAO,KAAME,YAAY,MAQvEI,EAAAA,IAAC,MAAA,CAAIJ,UAAW,oCAAoCA,IAClDC,SAAAG,EAAAA,IAAC,MAAA,CACCJ,UAAW,GATG,CAClBQ,GAAI,UACJC,GAAI,UACJC,GAAI,aAM0BZ,iFCVrBiB,EAAuB,KAClC,MAAM7B,SAAEA,wBAAUzC,EAAAsC,eAAuBA,EAAAlC,iBAAgBA,GAAqBvC,EAAUiC,IAAA,CACtF2C,SAAU3C,EAAM2C,SAChBzC,sBAAuBF,EAAME,sBAC7BsC,eAAgBxC,EAAMwC,eACtBlC,iBAAkBN,EAAMM,qBAGpBmE,SACJA,EAAAtG,cACAA,EAAAqB,UACAA,EAAAjB,MACAA,EAAAD,aACAA,EAAAoG,WACAA,EAAAC,WACAA,EAAAC,aACAA,EAAAC,aACAA,GCb2B,EAAC7D,EAAkC,MAChE,MAAM8D,UAAEA,GAAY,EAAAJ,WAAOA,EAAa,cAAAK,QAAeA,EAAAC,cAASA,GAAkBhE,GAE3E3C,EAAQ4G,GAAaC,EAAAA,SAA6B,OAClD/G,EAAegH,GAAoBD,EAAAA,UAAS,IAC5C1F,EAAW4F,GAAgBF,EAAAA,UAAS,IACpC3G,EAAO8G,GAAYH,EAAAA,SAAuB,OAC1C5G,EAAcgH,GAAmBJ,EAAAA,SAAoC,MAEtET,EAAWc,EAAAA,OAAgC,MAE3CZ,EAAaa,UACjBJ,GAAa,GACbC,EAAS,MAET,IACE,MAAMI,QAAoBC,EAAcf,WAAW,CAAED,eACrDO,EAAUQ,GACVN,GAAiB,GAGjB,MAAMQ,EAAOD,EAAcE,kBAC3BN,EAAgBK,GAEhBX,IAAgBS,EAClB,OAASI,GACP,MAAMtH,EAAQsH,aAAeC,MAAQD,EAAM,IAAIC,MAAM,+BACrDT,EAAS9G,GACTwG,IAAUxG,EACZ,CAAA,QACE6G,GAAa,EACf,GAyDIW,EAAU,KACdL,EAAcK,UACdd,EAAU,MACVE,GAAiB,GACjBG,EAAgB,OAsBlB,OAlBAU,EAAAA,UAAU,KACJ3H,GAAUoG,EAASwB,UACrBxB,EAASwB,QAAQC,UAAY7H,IAE9B,CAACA,IAGJ2H,EAAAA,UAAU,KACJlB,GACFH,IAIK,KACLoB,MAED,IAEI,CAEL1H,SACAF,gBACAqB,YACAjB,QACAD,eACAmG,WAGAE,aACAC,aA3FmBY,UACnBJ,GAAa,GACbC,EAAS,MAET,IACE,MAAMc,QAAkBT,EAAcd,eACtCK,EAAUkB,GAGV,MAAMR,EAAOD,EAAcE,kBAC3BN,EAAgBK,GAEhBX,IAAgBmB,EAClB,OAASN,GACP,MAAMtH,EAAQsH,aAAeC,MAAQD,EAAM,IAAIC,MAAM,2BACrDT,EAAS9G,GACTwG,IAAUxG,EACZ,CAAA,QACE6G,GAAa,EACf,GAyEAP,aAtEmBW,UACnB,IAAKf,EAASwB,UAAY5H,EAExB,OADAgH,EAAS,IAAIS,MAAM,qBACZ,KAGT,IACE,aAAaJ,EAAcb,aAAaJ,EAASwB,QACnD,OAASJ,GACP,MAAMtH,EAAQsH,aAAeC,MAAQD,EAAM,IAAIC,MAAM,2BAGrD,OAFAT,EAAS9G,GACTwG,IAAUxG,GACH,IACT,GA0DA6H,QAvDcZ,MAAOa,IACrB,UACQX,EAAcU,QAAQC,EAC9B,OAASR,GAET,GAmDAS,YAhDkBd,MAAOe,IACzB,UACQb,EAAcY,YAAYC,EAClC,OAASV,GAET,GA4CAE,UAGArB,WAAYgB,EAAcc,yBDtHxBC,CAAgB,CAClB1B,QAAUc,IACRlD,EAAS,CACP+D,KAAM,QACNC,QAASd,EAAIc,SAAW,6BAG5B3B,cAAe,KACbrC,EAAS,CACP+D,KAAM,UACNC,QAAS,uCAMfX,EAAAA,UAAU,KACJ1H,GACF4B,EAAsB5B,IAEvB,CAACA,EAAc4B,IA8BlB,OAAIV,IAEAoH,KAAC,MAAA,CAAInD,UAAU,4DACbC,SAAA,CAAAG,EAAAA,IAACU,EAAA,CAAQhB,KAAK,KAAKE,UAAU,SAC7BI,EAAAA,IAAC,IAAA,CAAEJ,UAAU,qBAAqBC,SAAA,8BAKpCnF,IAAWJ,IAAkBqB,IAE7BoH,KAAC,MAAA,CAAInD,UAAU,mEACbC,SAAA,CAAAG,EAAAA,IAAC,MAAA,CAAIJ,UAAU,gBAAgBC,SAAA,OAC/BG,EAAAA,IAAC,KAAA,CAAGJ,UAAU,6BAA6BC,SAAA,2BAC1CnF,GACCsF,EAAAA,IAAC,IAAA,CAAEJ,UAAU,iDAAkDC,WAAMiD,UAEvE9C,EAAAA,IAAC,IAAA,CAAEJ,UAAU,kDAAkDC,SAAA,wGAI/DG,EAAAA,IAACR,GAAOwD,QAASlC,EAAYrB,QAAQ,UAAUC,KAAK,KAAKG,SAAA,uBAQ7DkD,KAAC,MAAA,CAAInD,UAAU,kCACbC,SAAA,CAAAG,EAAAA,IAAC,QAAA,CACCiD,IAAKrC,EACLsC,UAAQ,EACRC,aAAW,EACXC,OAAK,EACLxD,UAAU,qCAIX,MAAA,CAAIA,UAAU,oCACbC,SAAAG,MAAC,MAAA,CAAIJ,UAAU,mBACbC,SAAAG,EAAAA,IAACO,EAAA,CACCtG,OAAM+F,IAAC,OAAA,CAAKJ,UAAU,UAAUC,SAAA,OAChCmD,QA1DiBrB,UACzB,UACQZ,IACNjC,EAAS,CACP+D,KAAM,UACNC,QAAS,eAA8B,gBAAfjC,EAA+B,QAAU,iBAErE,OAASmB,GACPlD,EAAS,CACP+D,KAAM,QACNC,QAAS,2BAEb,GA+CQlD,UAAU,2CACVY,MAAM,4BAMX,MAAA,CAAIZ,UAAU,qFACbC,SAAAG,MAAC,MAAA,CAAIJ,UAAU,mCACbC,SAAAG,EAAAA,IAACR,EAAA,CACCwD,QAlFYrB,UACpB,MAAM0B,QAAkBrC,IACpBqC,IACF5G,EAAiB4G,GACjB1E,EAAe,QAEfG,EAAS,CACP+D,KAAM,UACNC,QAAS,kCA2ELrD,QAAQ,UACRC,KAAK,KACLE,UAAU,6BAEVC,WAAAG,IAAC,OAAA,CAAKJ,UAAU,WAAWC,SAAA,aAMjCG,EAAAA,IAAC,MAAA,CAAIJ,UAAU,uCACbC,SAAAG,EAAAA,IAAC,MAAA,CAAIJ,UAAU,qDACbC,SAAAG,EAAAA,IAAC,MAAA,CAAIJ,UAAU"}